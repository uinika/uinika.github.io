<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Vue 2 技术栈归纳与精粹 - UinIO.com 电子技术实验室</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UinIO 电子技术实验室"><meta name="msapplication-TileImage" content="/images/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UinIO 电子技术实验室"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Vue 是一款高度封装的、开箱即用的、一栈式的前端框架，既可以结合 webpack 进行编译式前端开发，也适用基于 gulp、grunt 等自动化工具直接挂载至全局window使用。本文成文于 Vue2.4.x 版本发布之初，笔者生产环境当前使用的最新版本为 2.6.12。在经历多个前端重度交互项目的开发实践之后，笔者结合官方文档对 Vue 技术栈进行了全面的梳理、归纳和注解，因此本文"><meta property="og:type" content="blog"><meta property="og:title" content="Vue 2 技术栈归纳与精粹"><meta property="og:url" content="http://www.uinio.com/Web/Vue/"><meta property="og:site_name" content="UinIO.com 电子技术实验室"><meta property="og:description" content="Vue 是一款高度封装的、开箱即用的、一栈式的前端框架，既可以结合 webpack 进行编译式前端开发，也适用基于 gulp、grunt 等自动化工具直接挂载至全局window使用。本文成文于 Vue2.4.x 版本发布之初，笔者生产环境当前使用的最新版本为 2.6.12。在经历多个前端重度交互项目的开发实践之后，笔者结合官方文档对 Vue 技术栈进行了全面的梳理、归纳和注解，因此本文"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.uinio.com/images/favicon.png"><meta property="article:published_time" content="2016-11-26T16:00:00.000Z"><meta property="article:modified_time" content="2017-05-02T16:00:00.000Z"><meta property="article:author" content="Hank"><meta property="article:tag" content="JavaScript"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://www.uinio.com/images/favicon.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.uinio.com/Web/Vue/"},"headline":"Vue 2 技术栈归纳与精粹","image":["http://www.uinio.com/Web/Vue/logo.png"],"datePublished":"2016-11-26T16:00:00.000Z","dateModified":"2017-05-02T16:00:00.000Z","author":{"@type":"Person","name":"Hank"},"publisher":{"@type":"Organization","name":"UinIO.com 电子技术实验室","logo":{"@type":"ImageObject","url":{"text":"UinIO Lab"}}},"description":"Vue\r 是一款高度封装的、开箱即用的、一栈式的前端框架，既可以结合\r webpack 进行编译式前端开发，也适用基于 gulp、grunt\r 等自动化工具直接挂载至全局window使用。本文成文于 Vue2.4.x\r 版本发布之初，笔者生产环境当前使用的最新版本为\r 2.6.12。在经历多个前端重度交互项目的开发实践之后，笔者结合官方文档对\r Vue 技术栈进行了全面的梳理、归纳和注解，因此本文"}</script><link rel="canonical" href="http://www.uinio.com/Web/Vue/"><link rel="alternate" href="/atom.xml" title="UinIO.com 电子技术实验室" type="application/atom+xml"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://unpkg.com/highlight.js@11.7.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.font.im/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://unpkg.com/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://unpkg.com/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">UinIO Lab</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1514341594">Bilibili</a><a class="navbar-item" target="_blank" rel="noopener" href="https://www.zhihu.com/people/uinika">知乎</a><a class="navbar-item" target="_blank" rel="noopener" href="https://github.com/uinika">Github</a><a class="navbar-item" target="_blank" rel="noopener" href="https://gitee.com/uinika">Gitee</a><a class="navbar-item" href="/my/works.html">开源硬件</a><a class="navbar-item" href="/my/about.html">关于我</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2016-11-26T16:00:00.000Z" title="2016/11/27 00:00:00">2016-11-27</time>发表</span><span class="level-item"><time dateTime="2017-05-02T16:00:00.000Z" title="2017/5/3 00:00:00">2017-05-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Web-%E5%BC%80%E5%8F%91/">Web 开发</a></span><span class="level-item">2 小时读完 (大约14040个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Vue 2 技术栈归纳与精粹</h1><div class="content"><p>Vue
是一款<strong>高度封装的</strong>、<strong>开箱即用的</strong>、<strong>一栈式的前端框架</strong>，既可以结合
webpack 进行编译式前端开发，也适用基于 gulp、grunt
等自动化工具直接挂载至<code>全局window</code>使用。本文成文于 Vue2.4.x
版本发布之初，笔者生产环境当前使用的最新版本为
<code>2.6.12</code>。在经历多个前端重度交互项目的开发实践之后，笔者结合官方文档对
Vue 技术栈进行了全面的梳理、归纳和注解，因此本文可以作为 Vue2 官方<a target="_blank" rel="noopener" href="https://vuejs.org/v2/guide/">《Get Started》</a>
的补充性读物。</p>
<p><img src="/Web/Vue/logo.png"></p>
<p>Vue 2
框架体系及技术栈日趋完善，相较于<code>React+Reflux/Redux/MobX</code>技术栈，Vue
更加贴近 W3C 技术规范（<em>例如实现仍处于 W3C
草案阶段的<code>&lt;template&gt;</code>、<code>&lt;slot&gt;</code>、<code>is</code>等新特性，提供了良好易用的模板书写环境</em>），并且开源生态更加完整且易于配置，将
React 手动编码才能处理的细节，整合成为最佳实践并抽象为语法糖（比如 Vuex
中提供的<code>store</code>的模块化特性），使得开发人员得以将注意力聚焦于业务逻辑本身。</p>
<span id="more"></span>
<p>Vue2 的 API 结构相比 Angular 更加简洁，可以自由结合 TypeScript 或是
ECMAScript6
使用，并不特定于具体的预处理语言去获得最佳使用体验，框架本身的特性也并不强制依赖于各类炫酷的语法糖。Vue2
总体是一款非常<strong>轻量</strong>的技术栈，设计实现上紧随 W3C
技术规范，着力于处理<strong>HTML
模板组件化</strong>、<strong>事件和数据的作用域分离</strong>、<strong>多层级组件通信</strong>三个单页面前端开发当中的重点问题。本文在行文过程中，穿插描述了
Angular、React
等前端框架的异同与比较，供徘徊于各类前端技术选型的开发人员参考。</p>
<h2 id="vue-与-angular-的比较">Vue 与 Angular 的比较</h2>
<h3 id="组件化">组件化</h3>
<p>Angular 的设计思想照搬了 Java Web 开发当中 MVC
分层的概念，通过<code>Controller</code>切割并控制页面作用域，然后通过<code>Service</code>来实现复用，是一种对页面进行<strong>纵向</strong>分层的解耦思想。而
Vue 允许开发人员将页面抽象为若干独立的组件，即对页面的 DOM
结构进行<strong>横向</strong>的切割，通过组件的拼装来完成功能的复用、作用域控制。每个组件只提供<code>props</code>作为单一接口，并采用
Vuex
进行<code>state tree</code>的管理，从而便捷的实现组件间状态的通信与同步。</p>
<p><img src="/Web/Vue/components.png" title="组件化"></p>
<p>Angular
在<code>1.6.x</code>版本开始提供<code>component()</code>方法和<code>Component Router</code>来提供组件化开发的体验，但是依然需要依赖于<code>controller</code>和<code>service</code>的划分，实质上依然没有摆脱
MVC 纵向分层思想的桎梏。</p>
<h3 id="双向绑定与响应式绑定">双向绑定与响应式绑定</h3>
<p>Vue 遍历 data
对象上的所有属性，并通过原生<code>Object.defineProperty()</code>方法将这些属性转换为<code>getter/setter</code>（<em>只支持
IE9 及以上浏览器</em>）。Vue 内部通过这些 getter/setter
追踪依赖，在属性被修改时触发相应变化，从而完成模型到视图的双向绑定。每个
Vue 组件实例化时，都会自动调用<code>$watch()</code>遍历自身的 data
属性，并将其记录为依赖项，当这些依赖项的 setter 被触发时会通知 watcher
重新计算新值，然后触发 Vue
组件的<code>render()</code>函数重新渲染组件。</p>
<p><img src="/Web/Vue/data.png" title="响应式绑定的生命周期"></p>
<p>与 Aangular 双向数据绑定不同，Vue 组件不能检测到实例化后 data
属性的添加、删除，因为 Vue 组件在实例化时才会对属性执行 getter/setter
处理，所以 data 对象上的属性必须在实例化之前存在，Vue
才能够正确的进行转换。因而，Vue
提供的并非真正意义上的双向绑定，更准确的描述应该是<strong>单向绑定，响应式更新</strong>，而
Angular 即可以通过<code>$scope</code>影响 view
上的数据绑定，也可以通过视图层操作<code>$scope</code>上的对象属性，属于真正意义上的<strong>视图与模型的双向绑定</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">vm.<span class="property">a</span> = <span class="number">1</span>; <span class="comment">// 响应的</span></span><br><span class="line">vm.<span class="property">b</span> = <span class="number">2</span>; <span class="comment">// 非响应的</span></span><br></pre></td></tr></table></figure>
<p>因此，Vue
不允许在已经实例化的组件上添加新的动态根级响应属性（<em>即直接挂载在
data
下的属性</em>），但是可以使用<code>Vue.set(object, key, value)</code>方法添加响应式属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">set</span>(vm.<span class="property">someObject</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// vm.$set()实例方法是Vue.set()全局方法的别名</span></span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">someObject</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用Object.assign()或_.extend()也可以添加响应式属性，但是需要创建同时包含原属性、新属性的对象，从而有效触发watch()方法</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">someObject</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="variable language_">this</span>.<span class="property">someObject</span>, &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>Vue 对 DOM 的更新是异步的，观察到数据变化后 Vue
将开启一个队列，缓冲在同一事件循环（<em>Vue 的 event loop
被称为<strong>tick</strong> [tɪk]
n.标记，记号</em>）中发生的所有数据变化。如果同一个 watcher
被多次触发，只会向这个队列中推入一次。</p>
<blockquote>
<p>Vue 内部会通过原生 JavaScript
的<code>Promise.then</code>、<code>MutationObserver</code>、<code>setTimeout(fn, 0)</code>来执行异步队列当中的
watcher。</p>
</blockquote>
<p>在需要人为操作 DOM 的场景下，为了在 Vue 响应数据变化之后再更新
DOM，可以手动调用<code>Vue.nextTick(callback)</code>，并将 DOM
操作逻辑放置在 callback 回调函数中，从而确保响应式更新完成之后再进行 DOM
操作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 使用Vue实例上的.$nextTick()</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> vue = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#example&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">message</span>: <span class="string">&quot;123&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  vue.<span class="property">message</span> = <span class="string">&quot;new message&quot;</span>; <span class="comment">// 更改数据</span></span></span><br><span class="line"><span class="language-javascript">  vue.<span class="property">$el</span>.<span class="property">textContent</span> === <span class="string">&quot;new message&quot;</span>; <span class="comment">// false</span></span></span><br><span class="line"><span class="language-javascript">  vue.<span class="title function_">nextTick</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    vm.<span class="property">$el</span>.<span class="property">textContent</span> === <span class="string">&quot;new message&quot;</span>; <span class="comment">// true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 组件内使用vm.$nextTick()，不需要通过全局Vue，且回调函数中this自动指向当前Vue实例</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;example&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">template</span>: <span class="string">&quot;&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;没有更新&quot;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">updateMessage</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">message</span> = <span class="string">&quot;更新完成&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$el</span>.<span class="property">textContent</span>); <span class="comment">// 没有更新</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$nextTick(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$el</span>.<span class="property">textContent</span>); <span class="comment">// 更新完成</span></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="object.defineproperty">Object.defineProperty()</h3>
<p>Vue2 的响应式绑定依靠 JavaScript
原生提供的<code>Object.defineProperty()</code>实现，下面通过手动完成了一个简单的响应式绑定，来展示其内在的工作机制。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>输出：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> store = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> output = [];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(store, <span class="string">&quot;element&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 为store对象的element属性设置监听方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">set</span>: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    output[<span class="string">&quot;element&quot;</span>] = value;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">get</span>: <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> output[<span class="string">&quot;element&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> inputDOM = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> outputDOM = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#output&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">inputDOM.<span class="property">onkeyup</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  store.<span class="property">element</span> = inputDOM.<span class="property">value</span>; <span class="comment">// 为store对象设置element属性时候，会触该属性的set方法，此时inputDOM的value值将会赋予outputDOM。</span></span></span><br><span class="line"><span class="language-javascript">  outputDOM.<span class="property">value</span> = output[<span class="string">&quot;element&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/Web/Vue/bidirectional-bindings.gif"></p>
<p>上面的示例中，通过操作 DOM
的方式完成数据绑定显然不够优雅，目前使用较为广泛的是 Vue2 所使用的
Mustache
胡须语法<code>&#123;&#123;``&#125;&#125;</code>，因此如何更加语义化的完成数据绑定，成为下一步需要着手解决的问题：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用了Handlebar的胡须表达式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span>&gt;</span>Handlebar编译后输出：&#123;&#123;element&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> store = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> output = [];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(store, <span class="string">&quot;element&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 为store对象的element属性设置监听方法</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">set</span>: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      output[<span class="string">&quot;element&quot;</span>] = value || <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">get</span>: <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> output[<span class="string">&quot;element&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> inputDOM = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> outputHTML = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#output&quot;</span>).<span class="property">innerHTML</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">compile</span>(store, outputHTML); <span class="comment">// 初始化编译</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 绑定输入框事件，并且实时编译DOM</span></span></span><br><span class="line"><span class="language-javascript">  inputDOM.<span class="property">onkeyup</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    store.<span class="property">element</span> = inputDOM.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">compile</span>(store, outputHTML);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 通过Handlebar编译使用了胡须语法的DOM</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">compile</span>(<span class="params">store, html</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> template = <span class="title class_">Handlebars</span>.<span class="title function_">compile</span>(html);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#output&quot;</span>).<span class="property">innerHTML</span> = <span class="title function_">template</span>(store);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/Web/Vue/bidirectional-bindings-by-handlebar.gif"></p>
<p>看起来工作得学不错，不过生产环境下需要完成的功能更多，比如对用户输入的内容进行清洗，以防止
XSS；通过虚拟 DOM 和 diff 算法，更有效率的插入编译后的 DOM
等等，当然这些工作 Vue2
已经为你完成，开发人员只需要专注于业务代码本身。</p>
<h3 id="虚拟-dom">虚拟 DOM</h3>
<p><strong>Vritual DOM</strong>这个概念最先由 React 引入，是一种 DOM
对象差异化比较方案，即将 DOM 对象抽象成为 Vritual DOM 对象（<em>即
render()函数渲染的结果</em>），然后通过差异算法对 Vritual DOM
进行对比并返回差异，最后通过一个补丁算法将返回的差异对象应用在真实 DOM
结点。</p>
<p>Vue 当中的 Virtual DOM
对象被称为<strong>VNode</strong>（<em><code>template</code>当中的内容会被编译为
render()函数，而 render()函数接收一个
createElement()函数，并最终返回一个 VNode
对象</em>），补丁算法来自于另外一个开源项目<a target="_blank" rel="noopener" href="https://github.com/snabbdom/snabbdom">snabbdom</a>，即将真实的 DOM
操作映射成对虚拟 DOM 的操作，通过减少对真实 DOM
的操作次数来提升性能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">➜  vdom git:(dev) tree</span><br><span class="line">├── create-component.js</span><br><span class="line">├── create-element.js</span><br><span class="line">├── create-functional-component.js</span><br><span class="line">├── helpers</span><br><span class="line">│   ├── extract-props.js</span><br><span class="line">│   ├── get-first-component-child.js</span><br><span class="line">│   ├── index.js</span><br><span class="line">│   ├── is-async-placeholder.js</span><br><span class="line">│   ├── merge-hook.js</span><br><span class="line">│   ├── normalize-children.js</span><br><span class="line">│   ├── resolve-async-component.js</span><br><span class="line">│   └── update-listeners.js</span><br><span class="line">├── modules</span><br><span class="line">│   ├── directives.js</span><br><span class="line">│   ├── index.js</span><br><span class="line">│   └── ref.js</span><br><span class="line">├── patch.js</span><br><span class="line">└── vnode.js</span><br></pre></td></tr></table></figure>
<p>VNode 的设计出发点与 Angular
的<code>$digest</code>循环类似，都是通过<strong>减少对真实 DOM
的操作次数来提升性能</strong>，但是 Vue 的实现更加轻量化，摒弃了 Angular
为了实现双向绑定而提供的<code>$apply()</code>、<code>$eval()</code>封装函数，有选择性的实现
Angular 中<code>$compile()</code>、<code>$watch()</code>类似的功能。</p>
<h2 id="vue-对象的选项">Vue 对象的选项</h2>
<p>通过向构造函数<code>new Vue()</code>传入一个<code>option</code>对象去创建一个
Vue 实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="comment">// 数据</span></span><br><span class="line">  <span class="attr">data</span>: <span class="string">&quot;声明需要响应式绑定的数据对象&quot;</span>,</span><br><span class="line">  <span class="attr">props</span>: <span class="string">&quot;接收来自父组件的数据&quot;</span>,</span><br><span class="line">  <span class="attr">propsData</span>: <span class="string">&quot;创建实例时手动传递props，方便测试props&quot;</span>,</span><br><span class="line">  <span class="attr">computed</span>: <span class="string">&quot;计算属性&quot;</span>,</span><br><span class="line">  <span class="attr">methods</span>: <span class="string">&quot;定义可以通过vm对象访问的方法&quot;</span>,</span><br><span class="line">  <span class="attr">watch</span>: <span class="string">&quot;Vue实例化时会调用$watch()方法遍历watch对象的每个属性&quot;</span>,</span><br><span class="line">  <span class="comment">// DOM</span></span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;将页面上已存在的DOM元素作为Vue实例的挂载目标&quot;</span>,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;可以替换挂载元素的字符串模板&quot;</span>,</span><br><span class="line">  <span class="attr">render</span>: <span class="string">&quot;渲染函数，字符串模板的替代方案&quot;</span>,</span><br><span class="line">  <span class="attr">renderError</span>: <span class="string">&quot;仅用于开发环境，在render()出现错误时，提供另外的渲染输出&quot;</span>,</span><br><span class="line">  <span class="comment">// 生命周期钩子</span></span><br><span class="line">  <span class="attr">beforeCreate</span>: <span class="string">&quot;发生在Vue实例初始化之后，data observer和event/watcher事件被配置之前&quot;</span>,</span><br><span class="line">  <span class="attr">created</span>: <span class="string">&quot;发生在Vue实例初始化以及data observer和event/watcher事件被配置之后&quot;</span>,</span><br><span class="line">  <span class="attr">beforeMount</span>: <span class="string">&quot;挂载开始之前被调用，此时render()首次被调用&quot;</span>,</span><br><span class="line">  <span class="attr">mounted</span>: <span class="string">&quot;el被新建的vm.$el替换，并挂载到实例上之后调用&quot;</span>,</span><br><span class="line">  <span class="attr">beforeUpdate</span>: <span class="string">&quot;数据更新时调用，发生在虚拟DOM重新渲染和打补丁之前&quot;</span>,</span><br><span class="line">  <span class="attr">updated</span>: <span class="string">&quot;数据更改导致虚拟DOM重新渲染和打补丁之后被调用&quot;</span>,</span><br><span class="line">  <span class="attr">activated</span>: <span class="string">&quot;keep-alive组件激活时调用&quot;</span>,</span><br><span class="line">  <span class="attr">deactivated</span>: <span class="string">&quot;keep-alive组件停用时调用&quot;</span>,</span><br><span class="line">  <span class="attr">beforeDestroy</span>: <span class="string">&quot;实例销毁之前调用，Vue实例依然可用&quot;</span>,</span><br><span class="line">  <span class="attr">destroyed</span>: <span class="string">&quot;Vue实例销毁后调用，事件监听和子实例全部被移除，释放系统资源&quot;</span>,</span><br><span class="line">  <span class="comment">// 资源</span></span><br><span class="line">  <span class="attr">directives</span>: <span class="string">&quot;包含Vue实例可用指令的哈希表&quot;</span>,</span><br><span class="line">  <span class="attr">filters</span>: <span class="string">&quot;包含Vue实例可用过滤器的哈希表&quot;</span>,</span><br><span class="line">  <span class="attr">components</span>: <span class="string">&quot;包含Vue实例可用组件的哈希表&quot;</span>,</span><br><span class="line">  <span class="comment">// 组合</span></span><br><span class="line">  <span class="attr">parent</span>: <span class="string">&quot;指定当前实例的父实例，子实例用this.$parent访问父实例，父实例通过$children数组访问子实例&quot;</span>,</span><br><span class="line">  <span class="attr">mixins</span>: <span class="string">&quot;将属性混入Vue实例对象，并在Vue自身实例对象的属性被调用之前得到执行&quot;</span>,</span><br><span class="line">  <span class="attr">extends</span>: <span class="string">&quot;用于声明继承另一个组件，从而无需使用Vue.extend，便于扩展单文件组件&quot;</span>,</span><br><span class="line">  provide&amp;<span class="attr">inject</span>: <span class="string">&quot;2个属性需要一起使用，用来向所有子组件注入依赖，类似于React的Context&quot;</span>,</span><br><span class="line">  <span class="comment">// 其它</span></span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;允许组件递归调用自身，便于调试时显示更加友好的警告信息&quot;</span>,</span><br><span class="line">  <span class="attr">delimiters</span>: <span class="string">&quot;改变模板字符串的风格，默认为&#123;&#123;&#125;&#125;&quot;</span>,</span><br><span class="line">  <span class="attr">functional</span>: <span class="string">&quot;让组件无状态(没有data)和无实例(没有this上下文)&quot;</span>,</span><br><span class="line">  <span class="attr">model</span>: <span class="string">&quot;允许自定义组件使用v-model时定制prop和event&quot;</span>,</span><br><span class="line">  <span class="attr">inheritAttrs</span>: <span class="string">&quot;默认情况下，父作用域的非props属性绑定会应用在子组件的根元素上。当编写嵌套有其它组件或元素的组件时，可以将该属性设置为false关闭这些默认行为&quot;</span>,</span><br><span class="line">  <span class="attr">comments</span>: <span class="string">&quot;设为true时会保留并且渲染模板中的HTML注释&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Vue 实例通常使用<code>vm</code>（<em>View
Model</em>）变量来命名。</p>
</blockquote>
<h3 id="属性计算-computed">属性计算 computed</h3>
<p>在 HTML
模板表达式中放置太多业务逻辑，会让模板过重且难以维护。因此，可以考虑将模板中比较复杂的表达式拆分到
computed 属性当中进行计算。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 不使用计算属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; message.split(&quot;&quot;).reverse().join(&quot;&quot;) &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 将表达式抽象到计算属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Original message: &quot;&#123;&#123; message &#125;&#125;&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Computed reversed message: &quot;&#123;&#123; reversedMessage &#125;&#125;&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#example&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">message</span>: <span class="string">&quot;Hello&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">reversedMessage</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">message</span></span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">reverse</span>()</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>计算属性只在相关依赖发生改变时才会重新求值，这意味只要上面例子中的
message 没有发生改变，多次访问 reversedMessage
计算属性总会返回之前的计算结果，而不必再次执行函数，这是 computed 和
method 的一个重要区别。</p>
</blockquote>
<p>计算属性默认只拥有<strong>getter</strong>方法，但是可以自定义一个<strong>setter</strong>方法。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  ... ... ...</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">fullName</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// getter</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">lastName</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// setter</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">set</span>: <span class="keyword">function</span> (<span class="params">newValue</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> names = newValue.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">firstName</span> = names[<span class="number">0</span>]</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">lastName</span> = names[names.<span class="property">length</span> - <span class="number">1</span>]</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  ... ... ...</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 下面语句触发setter方法，firstName和lastName也会被相应更新</span></span></span><br><span class="line"><span class="language-javascript">  vm.<span class="property">fullName</span> = <span class="string">&quot;John Doe&quot;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="观察者属性-watch">观察者属性 watch</h3>
<p>通过 watch 属性可以手动观察 Vue
实例上的数据变动，当然也可以调用实例上的<code>vm.$watch</code>达到相同的目的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;watch-example&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Ask a yes/no question: <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;question&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; answer &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> watchExampleVM = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#watch-example&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">question</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">answer</span>: <span class="string">&quot;I cannot give you an answer until you ask a question!&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 如果question发生改变，该函数就会运行</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">question</span>: <span class="keyword">function</span>(<span class="params">newQuestion</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">answer</span> = <span class="string">&quot;Waiting for you to stop typing...&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">getAnswer</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// _.debounce是lodash当中限制操作频率的函数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">getAnswer</span>: _.<span class="title function_">debounce</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">question</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;?&quot;</span>) === -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">answer</span> = <span class="string">&quot;Questions usually contain a question mark. ;-)&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">answer</span> = <span class="string">&quot;Thinking...&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">var</span> vm = <span class="variable language_">this</span>;</span></span><br><span class="line"><span class="language-javascript">          axios</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">get</span>(<span class="string">&quot;https://yesno.wtf/api&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              vm.<span class="property">answer</span> = _.<span class="title function_">capitalize</span>(response.<span class="property">data</span>.<span class="property">answer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              vm.<span class="property">answer</span> = <span class="string">&quot;Error! Could not reach the API. &quot;</span> + error;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 这是用户停止输入等待的毫秒数</span></span></span><br><span class="line"><span class="language-javascript">        <span class="number">500</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用 watch
属性的灵活性在于，当监测到数据变化的时候，可以做一些设置中间状态之类的过渡处理。</p>
</blockquote>
<h3 id="混合属性-mixins">混合属性 mixins</h3>
<p>用来将指定的 mixin 对象复用到 Vue 组件当中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mixin对象</span></span><br><span class="line"><span class="keyword">var</span> mixin = &#123;</span><br><span class="line">  <span class="attr">created</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;混合对象的钩子被调用&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">conflicting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;from mixin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue属性</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">mixins</span>: [mixin],</span><br><span class="line">  <span class="attr">created</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;组件钩子被调用&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="attr">bar</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">conflicting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;from self&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// =&gt; &quot;混合对象的钩子被调用&quot;</span></span><br><span class="line"><span class="comment">// =&gt; &quot;组件钩子被调用&quot;</span></span><br><span class="line">vm.<span class="title function_">foo</span>(); <span class="comment">// =&gt; &quot;foo&quot;</span></span><br><span class="line">vm.<span class="title function_">bar</span>(); <span class="comment">// =&gt; &quot;bar&quot;</span></span><br><span class="line">vm.<span class="title function_">conflicting</span>(); <span class="comment">// =&gt; &quot;from self&quot;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>同名组件 option 对象的属性会被合并为数组依次进行调用，其中 mixin
对象里的属性会被首先调用。如果组件 option 对象的属性值是一个对象，则
mixin 中的属性会被忽略掉。</p>
</blockquote>
<h3 id="渲染函数-render">渲染函数 render()</h3>
<p>用来创建 VNode，该函数接收<code>createElement()</code>方法作为第 1
个参数，该方法调用后会返回一个虚拟 DOM（<em>即 VNode</em>）。</p>
<p>直接使用表达式，或者在<code>render()</code>函数内通过<code>createElement()</code>进行手动渲染，Vue
都会自动保持<code>blogTitle</code>属性的响应式更新。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; blogTitle &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">render</span>: <span class="keyword">function</span> (<span class="params">createElement</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="title function_">createElement</span>(<span class="string">&quot;h1&quot;</span>, <span class="variable language_">this</span>.<span class="property">blogTitle</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果组件是一个函数组件，render()还会接收一个 context
参数，以便为没有实例的函数组件提供上下文信息。</p>
</blockquote>
<p>通过 render()函数实现虚拟 DOM 比较麻烦，因此可以使用 Babel
插件<code>babel-plugin-transform-vue-jsx</code>在 render()函数中应用 JSX
语法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">AnchoredHeading</span> <span class="keyword">from</span> <span class="string">&quot;./AnchoredHeading.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#demo&quot;</span>,</span><br><span class="line">  <span class="title function_">render</span>(<span class="params">h</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">AnchoredHeading</span> <span class="attr">level</span>=<span class="string">&#123;1&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">span</span>&gt;</span> world!</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">AnchoredHeading</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="vue-对象全局-api">Vue 对象全局 API</h2>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">extend</span>(options); <span class="comment">// 通过继承一个option对象来创建一个Vue实例。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">nextTick</span>([callback, context]); <span class="comment">// 在下次DOM更新循环结束之后执行延迟回调。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">set</span>(target, key, value); <span class="comment">// 设置对象的属性，如果是响应式对象，将会触发视图更新。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">delete</span>(target, key); <span class="comment">// 删除对象的属性，如果是响应式对象，将会触发视图更新。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(id, [definition]); <span class="comment">// 注册或获取全局指令。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(id, [definition]); <span class="comment">// 注册或获取全局过滤器。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(id, [definition]); <span class="comment">// 注册或获取全局组件。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(plugin); <span class="comment">// 安装Vue插件。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">mixin</span>(mixin); <span class="comment">// 全局注册一个mixin对象。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">compile</span>(template); <span class="comment">// 在render函数中编译模板字符串。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">version</span>; <span class="comment">// 提供当前使用Vue的版本号。</span></span><br></pre></td></tr></table></figure>
<h3 id="vue.mixinmixin">Vue.mixin(mixin)</h3>
<p>使用全局 mixins 将会影响到所有<strong>之后创建</strong>的 Vue
实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为自定义选项myOption注入一个处理器。</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">  <span class="attr">created</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> myOption = <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">myOption</span>;</span><br><span class="line">    <span class="keyword">if</span> (myOption) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(myOption);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">myOption</span>: <span class="string">&quot;hello!&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// =&gt; &quot;hello!&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="vue.directiveid-definition">Vue.directive(id, [definition])</h3>
<p>Vue 允许注册自定义指令，用于对底层 DOM 进行操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&quot;focus&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">bind</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 指令第一次绑定到元素时调用，只会调用一次，可以用来执行一些初始化操作。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">inserted</span>: <span class="keyword">function</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    <span class="comment">// 被绑定元素插入父节点时调用。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">update</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 所在组件的VNode更新时调用，但是可能发生在其子VNode更新之前。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">componentUpdated</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 所在组件VNode及其子VNode全部更新时调用。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">unbind</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 指令与元素解绑时调用，只会被调用一次。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>钩子之间共享数据可以通过<code>HTMLElement</code>的<code>dataset</code>属性来进行（<em>即
HTML 标签上通过<code>data-</code>格式定义的属性</em>）。</p>
</blockquote>
<p>上面的钩子函数拥有如下参数：</p>
<ul>
<li>el: 指令绑定的 HTML 元素，可以用来直接操作 DOM。</li>
<li>vnode: Vue 编译生成的虚拟节点。</li>
<li>oldVnode:
之前的虚拟节点，仅在<code>update</code>、<code>componentUpdated</code>钩子中可用。</li>
<li>binding: 一个对象，包含以下属性：
<ul>
<li>name: 指令名称，不包括<code>v-</code>前缀。</li>
<li>value:
指令的绑定值，例如<code>v-my-directive="1 + 1"</code>中<code>value</code>的值是<code>2</code>。</li>
<li>oldValue:
指令绑定的之前一个值，仅在<code>update</code>、<code>componentUpdated</code>钩子中可用。</li>
<li>expression:
绑定值的字符串形式，例如<code>v-my-directive="1 + 1"</code>当中<code>expression</code>的值为<code>"1 + 1"</code>。</li>
<li>arg:
传给指令的参数，例如<code>v-my-directive:foo</code>中<code>arg</code>的值是<code>"foo"</code>。</li>
<li>modifiers:
包含修饰符的对象，例如<code>v-my-directive.foo.bar</code>的<code>modifiers</code>的值是<code>&#123;foo: true, bar: true&#125;</code>。</li>
</ul></li>
</ul>
<blockquote>
<p>上面参数除<code>el</code>之外，其它参数都应该是只读的，尽量不要对其进行修改操作。</p>
</blockquote>
<h3 id="vue.filterid-definition">Vue.filter(id, [definition])</h3>
<p>Vue 可以通过定义过滤器，进行一些常见的文本格式化，可以用于 mustache
插值和 v-bind
表达式当中，使用时通过管道符<code>|</code>添加在表达式尾部。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- in mustaches --&gt;</span></span><br><span class="line">&#123;&#123; message | capitalize &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- in v-bind --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">&quot;rawId | formatId&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- capitalize filter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">capitalize</span>: <span class="keyword">function</span>(<span class="params">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        value = value.<span class="title function_">toString</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> value.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + value.<span class="title function_">slice</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>过滤器可以串联使用，也可以传入参数。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; message | filterA | filterB &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; message | filterA(&quot;arg1&quot;, arg2) &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="vue.useplugin">Vue.use(plugin)</h3>
<p>Vue 通过插件来添加一些全局功能，Vue
插件都会覆写其<code>install()</code>方法，该方法第 1
个参数是<code>Vue构造器</code>, 第 2
个参数是可选的<code>option对象</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">MyPlugin</span>.<span class="property">install</span> = <span class="keyword">function</span>(<span class="params">Vue, options</span>) &#123;</span><br><span class="line">  <span class="comment">// 1. 添加全局方法或属性</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="property">myGlobalMethod</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 添加全局资源</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&quot;my-directive&quot;</span>, &#123;</span><br><span class="line">    <span class="title function_">bind</span>(<span class="params">el, binding, vnode, oldVnode</span>) &#123;&#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 注入组件</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">    <span class="attr">created</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. 添加实例方法</span></span><br><span class="line">  <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$myMethod</span> = <span class="keyword">function</span>(<span class="params">methodOptions</span>) &#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过全局方法<code>Vue.use()</code>使用指定插件，使用的时候也可以传入一个
option 对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">MyPlugin</span>, &#123; <span class="attr">someOption</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>vue-router 等插件检测到 Vue
是全局对象时会自动调用<code>Vue.use()</code>，如果在 CommonJS
模块环境中，则需要显式调用<code>Vue.use()</code>。</p>
</blockquote>
<h2 id="实例属性和方法">实例属性和方法</h2>
<p>Vue 实例暴露了一系列带有前缀<strong>$</strong>的实例属性与方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>();</span><br><span class="line">vm = &#123;</span><br><span class="line">  <span class="comment">// Vue实例属性的代理</span></span><br><span class="line">  <span class="attr">$data</span>: <span class="string">&quot;被watch的data对象&quot;</span>,</span><br><span class="line">  <span class="attr">$props</span>: <span class="string">&quot;当前组件收到的props&quot;</span>,</span><br><span class="line">  <span class="attr">$el</span>: <span class="string">&quot;Vue实例使用的根DOM元素&quot;</span>,</span><br><span class="line">  <span class="attr">$options</span>: <span class="string">&quot;当前Vue实例的初始化选项&quot;</span>,</span><br><span class="line">  <span class="attr">$parent</span>: <span class="string">&quot;父组件Vue对象的实例&quot;</span>,</span><br><span class="line">  <span class="attr">$root</span>: <span class="string">&quot;根组件Vue对象的实例&quot;</span>,</span><br><span class="line">  <span class="attr">$children</span>: <span class="string">&quot;当前实例的直接子组件&quot;</span>,</span><br><span class="line">  <span class="attr">$slots</span>: <span class="string">&quot;访问被slot分发的内容&quot;</span>,</span><br><span class="line">  <span class="attr">$scopedSlots</span>: <span class="string">&quot;访问scoped slots&quot;</span>,</span><br><span class="line">  <span class="attr">$refs</span>: <span class="string">&quot;包含所有拥有ref注册的子组件&quot;</span>,</span><br><span class="line">  <span class="attr">$isServer</span>: <span class="string">&quot;判断Vue实例是否运行于服务器&quot;</span>,</span><br><span class="line">  <span class="attr">$attrs</span>: <span class="string">&quot;包含父作用域中非props的属性绑定&quot;</span>,</span><br><span class="line">  <span class="attr">$listeners</span>: <span class="string">&quot;包含了父作用域中的v-on事件监听器&quot;</span>,</span><br><span class="line">  <span class="comment">// 数据</span></span><br><span class="line">  <span class="attr">$watch</span>: <span class="string">&quot;观察Vue实例变化的表达式、计算属性函数&quot;</span>,</span><br><span class="line">  <span class="attr">$set</span>: <span class="string">&quot;全局Vue.set的别名&quot;</span>,</span><br><span class="line">  <span class="attr">$delete</span>: <span class="string">&quot;全局Vue.delete的别名&quot;</span>,</span><br><span class="line">  <span class="comment">// 事件</span></span><br><span class="line">  <span class="attr">$on</span>: <span class="string">&quot;监听当前实例上的自定义事件，事件可以由vm.$emit触发&quot;</span>,</span><br><span class="line">  <span class="attr">$once</span>: <span class="string">&quot;监听一个自定义事件，触发一次之后就移除监听器&quot;</span>,</span><br><span class="line">  <span class="attr">$off</span>: <span class="string">&quot;移除自定义事件监听器&quot;</span>,</span><br><span class="line">  <span class="attr">$emit</span>: <span class="string">&quot;触发当前实例上的事件&quot;</span>,</span><br><span class="line">  <span class="comment">// 生命周期</span></span><br><span class="line">  <span class="attr">$mount</span>: <span class="string">&quot;手动地挂载一个没有挂载的Vue实例&quot;</span>,</span><br><span class="line">  <span class="attr">$forceUpdate</span>: <span class="string">&quot;强制Vue实例重新渲染，仅影响实例本身和插入插槽内容的子组件&quot;</span>,</span><br><span class="line">  <span class="attr">$nextTick</span>: <span class="string">&quot;将回调延迟到下次DOM更新循环之后执行&quot;</span>,</span><br><span class="line">  <span class="attr">$destroy</span>: <span class="string">&quot;完全销毁一个实例&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="refs-属性">$refs 属性</h3>
<p><strong>子</strong>组件指定<code>ref</code>属性之后，可以通过<strong>父</strong>组件的<code>$refs</code>实例属性对其进行访问
。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">user-profile</span> <span class="attr">ref</span>=<span class="string">&quot;profile&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">user-profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> parent = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123; <span class="attr">el</span>: <span class="string">&quot;#parent&quot;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> child = parent.<span class="property">$refs</span>.<span class="property">profile</span>; <span class="comment">// 访问子组件</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><span class="math inline">\(refs会在组件渲染完毕后填充，是非响应式的，仅作为需要直接访问子组件的应急方案，因此要**避免在模板或计算属性中使用\)</span>refs**。</p>
</blockquote>
<h2 id="生命周期">生命周期</h2>
<p>每个 Vue
实例在创建时，都需要经过一系列初始化过程（<em>设置数据监听、编译模板、挂载实例到
DOM、在数据变化时更新
DOM</em>），并在同时运行一些钩子函数，让开发人员能够在特定生命周期内执行自己的代码。</p>
<p><img src="/Web/Vue/lifecycle.png" title="组件的生命周期"></p>
<blockquote>
<p>不要在 Vue
实例的属性和回调上使用箭头函数，比如<code>created: () =&gt; console.log(this.a)</code>或<code>vm.$watch("a", newValue =&gt; this.myMethod())</code>。因为箭头函数的
this 与父级上下文绑定，并不指向 Vue
实例本身，所以前面代码中的<code>this.a</code>或<code>this.myMethod</code>将会是<code>undefined</code>。</p>
</blockquote>
<blockquote>
<p>通过 jQuery 对 DOM
进行的操作可以放置在<code>Mounted</code>属性上进行，即当 Vue
组件已经完成在 DOM 上挂载的时候。</p>
</blockquote>
<h2 id="数据绑定">数据绑定</h2>
<p>Vue 视图层通过<a target="_blank" rel="noopener" href="http://mustache.github.io/">Mustache</a><code>["mʌstæʃ]</code>语法与
Vue 实例中的 data
属性进行响应式绑定，但是也可以通过内置指令<code>v-once</code>完成一个单向的绑定，再或者通过<code>v-html</code>指令将绑定的字符串输出为
HTML，虽然这样很容易招受 XSS 攻击。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Message: &#123;&#123; result &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-once</span>&gt;</span>一次性绑定: &#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">&quot;rawHtml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Mustache 不能用于 HTML
属性，此时需要借助于<code>v-bind</code>指令。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">&quot;dynamicId&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-bind:disabled</span>=<span class="string">&quot;isButtonDisabled&quot;</span>&gt;</span>Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="绑定-html-的-class-和-style">绑定 HTML 的 class 和 style</h3>
<p>直接操作<code>class</code>与<code>style</code>属性是前端开发当中的常见需求，Vue
通过<code>v-bind:class</code>和<code>v-bind:style</code>指令有针对性的对这两种操作进行了增强。</p>
<h4 id="v-bindclass">v-bind:class</h4>
<p>绑定 HTML 的<code>class</code>属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Vue对象中的data --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">isActive</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">hasError</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">classObject</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">active</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;text-danger&quot;</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 直接绑定class到一个对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;classObject&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 直接绑定class到对象的属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;static&quot;</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;&#123; active: isActive, &quot;</span><span class="attr">text-danger</span>&quot;<span class="attr">:</span> <span class="attr">hasError</span> &#125;&quot;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;static active&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以传递一个数组给<code>v-bind:class</code>从而同时设置多个 class
属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Vue对象中的data --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">activeClass</span>: <span class="string">&quot;active&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">errorClass</span>: <span class="string">&quot;text-danger&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 绑定class到计算属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;[activeClass, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;active text-danger&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用三目运算符，始终添加errorClass，只在isActive为true时添加activeClass --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;[isActive ? activeClass : &quot;</span>&quot;, <span class="attr">errorClass</span>]&quot;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在数组中使用对象可以避免三目运算符的繁琐 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;[&#123; active: isActive &#125;, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当在自定义组件上使用<code>class</code>属性时，这些属性将会被添加到该组件的根元素上面，这一特性同样适用于<code>v-bind:class</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 声明一个组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">template</span>: <span class="string">&quot;&lt;p class=&quot;</span>foo bar<span class="string">&quot;&gt;Hi&lt;/p&gt;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isActive</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 添加2个class属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">class</span>=<span class="string">&quot;baz boo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;foo bar baz boo&quot;</span>&gt;</span>Hi<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用v-bind:class --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;&#123; active: isActive &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;foo bar active&quot;</span>&gt;</span>Hi<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-bindstyle">v-bind:style</h4>
<p>绑定 HTML 的<code>style</code>属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">styleObject</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">fontSize</span>: <span class="string">&quot;13px&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">styleHeight</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">height</span>: 10rem;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">styleWidth</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">width</span>: 20rem;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  ... ...</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:style</span>=<span class="string">&quot;styleObject&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用数组可以将多个样式合并到一个HTML元素上面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:style</span>=<span class="string">&quot;[styleHeight, styleWidth]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用<code>v-bind:style</code>时 Vue 会自动添加<em>prefix
前缀</em>，常见的 prefix 前缀如下：</p>
<ul>
<li><code>-webkit-</code> Chrome、Safari、新版 Opera、所有 iOS
浏览器(包括 iOS 版 Firefox)，几乎所有 WebKit 内核浏览器。</li>
<li><code>-moz-</code> 针对 Firefox 浏览器。</li>
<li><code>-o-</code> 未使用 WebKit 内核的老版本 Opera。</li>
<li><code>-ms-</code> 微软的 IE 以及 Edge 浏览器。</li>
</ul>
<h3 id="使用-javascript-表达式">使用 JavaScript 表达式</h3>
<p>Vue 对于所有数据绑定都提供了 JavaScript
表达式支持，但是每个绑定只能使用<strong>1</strong>个表达式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; number + 1 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;&#123; ok ? &quot;YES&quot; : &quot;NO&quot; &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message.split(&quot;&quot;).reverse().join(&quot;&quot;) &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">&quot;&quot;</span><span class="attr">list-</span>&quot; + <span class="attr">id</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 这是语句，不是表达式 --&gt;</span></span><br><span class="line">&#123;&#123; var a = 1 &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- if流程控制属于多个表达式，因此不会生效，但可以使用三元表达式 --&gt;</span></span><br><span class="line">&#123;&#123; if (ok) &#123; return message &#125; &#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="v-model-双向数据绑定">v-model 双向数据绑定</h3>
<p><code>v-model</code>指令实质上是<code>v-on</code>和<code>v-bind</code>的糖衣语法，该指令会接收一个<code>value属性</code>，存在新值时则触发一个<code>input事件</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用v-model的版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;something&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用v-on和v-bind的版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind:value</span>=<span class="string">&quot;something&quot;</span> <span class="attr">v-on:input</span>=<span class="string">&quot;something = $event.target.value&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 也可以自定义输入域的响应式绑定 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">custom-input</span> <span class="attr">v-bind:value</span>=<span class="string">&quot;something&quot;</span> <span class="attr">v-on:input</span>=<span class="string">&quot;something = arguments[0]&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">custom-input</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>单选框、复选框一类的输入域将 value
属性作为了其它用途，因此可以通过组件的<code>model</code>选项来避免冲突：</p>
</blockquote>
<h2 id="内置指令">内置指令</h2>
<p>带有<code>v-</code>前缀，当表达式值发生变化时，会响应式的将影响作用于
DOM。指令可以接收后面以<code>:</code>表示的<strong>参数</strong>（<em>被指令内部的
arg
属性接收</em>），或者以<code>.</code>开头的<strong>修饰符</strong>（<em>指定该指令以特殊方式绑定</em>）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;seen&quot;</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 绑定事件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">&quot;url&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 绑定属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">&quot;doSomething&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- .prevent修饰符会告诉v-on指令对于触发的事件调用event.preventDefault() --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>=<span class="string">&quot;onSubmit&quot;</span>&gt;</span>&lt;/form</span><br><span class="line">&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Vue
为<code>v-bind</code>和<code>v-on</code>这两个常用的指令提供了简写形式<code>:</code>和<code>@</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- v-bind --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">&quot;url&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">&quot;url&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- v-on --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">&quot;doSomething&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">&quot;doSomething&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>目前，Vue 在<em>2.4.2</em>版本当中提供了如下的内置指令：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-text</span> = <span class="string">&quot;更新元素的textContent&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-html</span> = <span class="string">&quot;更新元素的innerHTML&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-show</span> = <span class="string">&quot;根据表达式的true/false，切换HTML元素的display属性&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-for</span> = <span class="string">&quot;遍历内部的HTML元素&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-pre</span> = <span class="string">&quot;跳过表达式渲染过程，可以显示原始的Mustache标签&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-cloak</span> = <span class="string">&quot;保持在HTML元素上直到关联实例结束编译，可以隐藏未编译的Mustache&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-once</span> = <span class="string">&quot;只渲染元素和组件一次&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 根据表达式的true和false来决定是否渲染元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;type === &quot;</span><span class="attr">A</span>&quot;&quot;&gt;</span>A<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &quot;</span><span class="attr">B</span>&quot;&quot;&gt;</span>B<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &quot;</span><span class="attr">C</span>&quot;&quot;&gt;</span>C<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span>Not A/B/C<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 动态地绑定属性或prop到表达式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-bind:attrOrProp</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.prop</span> = <span class="string">&quot;被用于绑定DOM属性&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.camel</span> = <span class="string">&quot;将kebab-case特性名转换为camelCase&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.sync</span> = <span class="string">&quot;语法糖，会扩展成一个更新父组件绑定值的v-on监听器&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 绑定事件监听器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:eventName</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.stop</span> = <span class="string">&quot;调用event.stopPropagation()&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.prevent</span> = <span class="string">&quot;调用event.preventDefault()&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.capture</span> = <span class="string">&quot;添加事件监听器时使用capture模式&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.self</span> = <span class="string">&quot;当事件是从监听器绑定的元素本身触发时才触发回调&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.native</span> = <span class="string">&quot;监听组件根元素的原生事件&quot;</span><span class="attr">-</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.once</span> = <span class="string">&quot;只触发一次回调&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.left</span> = <span class="string">&quot;点击鼠标左键触发&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.right</span> = <span class="string">&quot;点击鼠标右键触发&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.middle</span> = <span class="string">&quot;点击鼠标中键触发&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.passive</span> = <span class="string">&quot;以&#123;passive: true&#125;模式添加监听器&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.</span>&#123;<span class="attr">keyCode</span> | <span class="attr">keyAlias</span>&#125; = <span class="string">&quot;触发特定键触事件&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 表单控件的响应式绑定 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.lazy</span> = <span class="string">&quot;取代input监听change事件&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.number</span> = <span class="string">&quot;输入字符串转为数字&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">.trim</span> = <span class="string">&quot;过滤输入的首尾空格&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="组件">组件</h2>
<p>组件可以扩展 HTML
元素功能，并且封装可重用代码。可以通过<code>Vue.component( id, [definition] )</code>注册或者获取全局组件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册组件，传入一个扩展过的构造器</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123; ... &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册组件，传入一个option对象（会自动调用Vue.extend）</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, &#123; ... &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取注册的组件(始终返回构造器)</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">MyComponent</span> = <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>下面代码创建了一个 Vue
实例，并将自定义组件<code>my-component</code>挂载至 HTML 当中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 注册自定义组件</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;A custom component!&lt;/div&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 创建Vue根实例</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#example&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 原始模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my-component</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>A custom component!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>is 属性</li>
</ul>
<p>浏览器解析完 HTML 之后才会渲染 Vue
表达式，但是诸如<code>&lt;ul&gt; &lt;ol&gt; &lt;table&gt; &lt;select&gt;</code>限制了可以被包裹的
HTML 元素，而<code>&lt;option&gt;</code>只能出现在某些 HTML
元素内部，造成 Vue 表达式可能不会被正确的渲染。因此，Vue
提供<code>is</code>作为属性别名来解决该问题。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 不正确的方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my-row</span>&gt;</span>...<span class="tag">&lt;/<span class="name">my-row</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用is的正确方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span> <span class="attr">is</span>=<span class="string">&quot;my-row&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>data 必须是函数</li>
</ul>
<p><code>Vue.component()</code>传入的 data
属性不能是对象，而必须是函数。这样做的目的是避免组件在相同模板的多个位置被复用时，仅仅返回对象会造成组件间的数据被相互污染，而通过函数每次都返回全新的
data 对象能完美的规避这个问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;simple-counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;button v-on:click=&quot;</span>counter += <span class="number">1</span><span class="string">&quot;&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">a</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="attr">b</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>父子组件之间的通信</li>
</ul>
<p>父组件通过<code>props</code>向下传递数据给子组件，子组件通过<code>events</code>给父组件发送消息，即<strong>props
down, events up</strong>。</p>
<p><img src="/Web/Vue/props-events.png" title="父子组件通信"></p>
<h3 id="props">props</h3>
<p>虽然每个组件的作用域都是独立的，但是可以通过<code>props属性</code>向子组件传递数据，这是一种<strong>单向数据流</strong>的体现形式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;child&quot;</span>, &#123;</span><br><span class="line">  <span class="comment">// 声明props</span></span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&quot;message&quot;</span>],</span><br><span class="line">  <span class="comment">// 和data属性一样，prop也可以在vm通过this.message进行引用</span></span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不要在子组件内部修改 props，这样会导致后台报错。</p>
</blockquote>
<h4 id="命名方式转换">命名方式转换</h4>
<p>因为 HTML 并不区分大小写，所以 kebab-case(<em>驼峰</em>)风格命名的
props，在组件中会以 camelCased(<em>短横线隔开</em>)风格被接收。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- camelCase in JavaScript --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">Vue.component(&quot;child&quot;, &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  props: [&quot;myMessage&quot;],</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  template: &quot;<span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="template-variable">&#123;&#123; <span class="name">myMessage</span> &#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>&quot;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"></span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!-- kebab-case in HTML --&gt;</span></span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"><span class="tag">&lt;<span class="name">child</span> <span class="attr">my-message</span>=<span class="string">&quot;hello!&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span></span></span></span><br></pre></td></tr></table></figure>
<h4 id="动态-props">动态 props</h4>
<p>可以通过<code>v-bind</code>指令，响应式的绑定父组件数据到子组件的
props。当父组件数据变化时，该变化也会传导至子组件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;parentMsg&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child</span> <span class="attr">v-bind:my-message</span>=<span class="string">&quot;parentMsg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用<code>v-bind</code>可以让其参数值能够以 JavaScript
表达式的方式被解析，否则所有传入的 props
都会被子组件认为是字符串类型。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 传递的是字符串&quot;1&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">some-prop</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 传递实际的 number --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">v-bind:some-prop</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="验证-props">验证 props</h4>
<p>可以为组件的 props 指定验证规则，如果传入数据不符合要求，Vue
会发出相应警告，这样可以有效提高组件的健壮性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;example&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="comment">// 基础类型检测</span></span><br><span class="line">    <span class="attr">propA</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="comment">// 多种类型</span></span><br><span class="line">    <span class="attr">propB</span>: [<span class="title class_">String</span>, <span class="title class_">Number</span>],</span><br><span class="line">    <span class="comment">// 必传且是字符串</span></span><br><span class="line">    <span class="attr">propC</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 数字，有默认值</span></span><br><span class="line">    <span class="attr">propD</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="number">100</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 数组或对象的默认值由1个工厂函数返回</span></span><br><span class="line">    <span class="attr">propE</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Object</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&quot;hello&quot;</span> &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 自定义验证函数</span></span><br><span class="line">    <span class="attr">propF</span>: &#123;</span><br><span class="line">      <span class="attr">validator</span>: <span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> value &gt; <span class="number">10</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>props</code>会在组件实例创建之前进行校验。</p>
</blockquote>
<h4 id="组件的非-props-属性">组件的非 props 属性</h4>
<p>组件可以接收任意传入的属性，这些属性都会被添加到组件 HTML
模板的根元素上（<em>无论有没有在 props 中定义</em>）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 带有属性的自定义组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bs-date-input</span> <span class="attr">data-3d-date-picker</span>=<span class="string">&quot;true&quot;</span> <span class="attr">class</span>=<span class="string">&quot;date-picker-theme-dark&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bs-date-input</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染出来的组件，class属性被合并 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">&quot;date&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">data-3d-date-picker</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;form-control date-picker-theme-dark&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>父组件传递给子组件的属性可能会覆盖子组件本身的属性，因而会对子组件造成破坏和污染。</p>
</blockquote>
<h3 id="事件">事件</h3>
<p>子组件可以通过 Vue 的自定义事件与父组件进行通信。</p>
<p>每个 Vue 实例都实现了如下 API，但是并不能直接通过$on
监听子组件冒泡的事件，而必须使用 v-on 指令。</p>
<ol type="1">
<li><code>$on(eventName)</code> 监听事件</li>
<li><code>$emit(eventName)</code> 触发事件</li>
</ol>
<blockquote>
<p><code>$on</code>和<code>$emit</code>并不是<code>addEventListener</code>和<code>dispatchEvent</code>的别名。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;counter-event-example&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; total &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">&quot;incrementTotal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">&quot;incrementTotal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;button-counter&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">template</span>: <span class="string">&quot;&lt;button v-on:click=&quot;</span>incrementCounter<span class="string">&quot;&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">counter</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 子组件事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">incrementCounter</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">counter</span> += <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;increment&quot;</span>) <span class="comment">//向父组件冒泡事件</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#counter-event-example&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">total</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 父组件事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">incrementTotal</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">total</span> += <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>.native</code>修饰符</li>
</ul>
<p>开发人员也可以在组件的根元素上监听原生事件，这个时候需要借助到<code>.native</code>修饰符。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">v-on:click.native</span>=<span class="string">&quot;doTheThing&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>.sync</code>修饰符</li>
</ul>
<p>Vue
中的<code>props</code>本质是不能进行响应式绑定的，以防止破坏单向数据流，造成多个子组件对父组件状态形成污染。但是生产环境下，<code>props</code>响应式绑定的需求是切实存在的。因此，Vue
将<code>.sync</code>修饰符封装为糖衣语法，父组件在子组件的 props
使用该修饰符后，父组件会为 props
自动绑定<code>v-on</code>事件，子组件则在监听到 props
变化时向父组件<code>$emit</code>更新事件，从而让父组件的<code>props</code>能够与子组件进行同步。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用.sync修饰符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">:foo.sync</span>=<span class="string">&quot;bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 被自动扩展为如下形式，该组件的子组件会通过this.$emit(&quot;update:foo&quot;, newValue)显式触发更新事件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">:foo</span>=<span class="string">&quot;bar&quot;</span> @<span class="attr">update:foo</span>=<span class="string">&quot;val =&gt; bar = val&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>平行组件通信</li>
</ul>
<p>非父子关系的组件进行通信时，可以使用一个<strong>空</strong>的 Vue
实例作为<strong>中央事件总线</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bus = <span class="keyword">new</span> <span class="title class_">Vue</span>()</span><br><span class="line"><span class="comment">// 触发组件A中的事件</span></span><br><span class="line">bus.$emit(<span class="string">&quot;id-selected&quot;</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment">// 在组件B监听事件</span></span><br><span class="line">bus.$on(<span class="string">&quot;id-selected&quot;</span>, <span class="keyword">function</span> (<span class="params">id</span>) &#123;</span><br><span class="line">  ... ... ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>更好的方式是借助 VueX 或者 Redux 之类的 flux 状态管理库。</p>
</blockquote>
<h3 id="slot">slot</h3>
<p>可以将父组件的内容混入到子组件的模板当中，此时可以在子组件中使用<code>&lt;slot&gt;</code>作为父组件内容的插槽。</p>
<blockquote>
<p>父组件模板的内容在父组件作用域内编译，子组件模板的内容在子组件作用域内编译。</p>
</blockquote>
<h4 id="匿名插槽">匿名插槽</h4>
<p>当子组件只有一个没有属性的<code>&lt;slot&gt;</code>时，父组件全部内容片段将插入到插槽所在的
DOM 位置，并替换插槽标签本身。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件my-component的模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Child<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span></span><br><span class="line">    父组件没有需要插入的内容时显示</span><br><span class="line">  <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件模板中使用my-component --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Parent<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Parent<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Child<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>&lt;slot&gt;</code>标签中的内容会在子组件作用域内编译，并在父组件没有需要插入的内容时才会显示。</p>
</blockquote>
<h4 id="具名插槽">具名插槽</h4>
<p>可以通过<code>&lt;slot&gt;</code>元素的<code>name</code>属性来配置如何分发内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;header&quot;</span>&gt;</span>Header<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span>&gt;</span>Footer<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">app</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Header<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Footer<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>匿名 slot 会作为没有匹配内容的父组件片段的插槽。</p>
</blockquote>
<h4 id="作用域插槽">作用域插槽</h4>
<p>子组件通过<code>props</code>传递数据给<code>&lt;slot&gt;</code>插槽，父组件使用带有<code>scope</code>属性的<code>&lt;template&gt;</code>来表示表示当前作用域插槽的模板，<code>scope</code>值对应的变量会接收子组件传递来的
props 对象。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件通过props传递数据给插槽 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">text</span>=<span class="string">&quot;hello from child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件使用带有scope属性的&lt;template&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">scope</span>=<span class="string">&quot;props&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello from parent<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; props.text &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello from parent<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello from child<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="函数化组件">函数化组件</h3>
<p>即无状态（<em>没有 data</em>）无实例（<em>没有 this
上下文</em>）的组件，渲染开销较小，且不会出现在<code>Vue devtools</code>当中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">functional</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 通过提供context参数为没有实例的函数组件提供上下文信息</span></span><br><span class="line">  <span class="attr">render</span>: <span class="keyword">function</span>(<span class="params">createElement, context</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// Props可选</span></span><br><span class="line">  <span class="attr">props</span>: &#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="动态组件">动态组件</h3>
<p>使用<code>&lt;component&gt;</code>元素并动态绑定其<code>is</code>属性，可以让多个组件使用相同的
Vue 对象挂载点，并实现动态切换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#example&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">currentView</span>: <span class="string">&quot;home&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">home</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/* ... */</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">posts</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/* ... */</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">archive</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/* ... */</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">&quot;currentView&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 组件在vm.currentview变化时改变！ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果需要将切换的组件保持在内存，保留其状态并且避免重新渲染，可以使用
Vue 内置的<code>keep-alive</code>指令。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;currentView&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 非活动组件将被缓存！ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="组件异步加载">组件异步加载</h3>
<p>Vue 允许将组件定义为工厂函数，从而异步的解析组件定义。Vue
只会在组件渲染时才触发工厂函数，并将结果缓存起来用于后续渲染。定义组件的工厂函数将会接收
resolve（<em>接收到从服务器下载的 Vue 组件 options 时被调用</em>）和
reject（<em>当远程 Vue 组件 options
加载失败时调用</em>）回调函数作为参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;async-example&quot;</span>, <span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 将组件定义传递到resolve回调函数当中</span></span><br><span class="line">    <span class="title function_">resolve</span>(&#123;</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;I am async!&lt;/div&gt;&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以结合 Webpack 提供的<strong>代码切割</strong>功能，将 Vue 组件的
options 对象提取到单独 JavaScript 文件，从而实现异步的按需加载。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用webpack的require()来进行异步代码块切割</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;async-webpack-example&quot;</span>, <span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">  <span class="built_in">require</span>([<span class="string">&quot;./my-async-component&quot;</span>], resolve);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用webpack的import()来进行异步代码块切割</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;async-webpack-example&quot;</span>, <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;./my-async-component&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>从 Vue 2.3.0 版本开始，可以通过下面的方式来定义一个异步组件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">AsyncWebpackExample</span> = (<span class="params"></span>) =&gt; (&#123;</span><br><span class="line">  <span class="attr">component</span>: <span class="keyword">import</span>(<span class="string">&quot;./MyComp.vue&quot;</span>), <span class="comment">// 需要加载的组件</span></span><br><span class="line">  <span class="attr">loading</span>: <span class="title class_">LoadingComp</span>, <span class="comment">// loading时渲染的组件</span></span><br><span class="line">  <span class="attr">error</span>: <span class="title class_">ErrorComp</span>, <span class="comment">// 出错时渲染的组件</span></span><br><span class="line">  <span class="attr">delay</span>: <span class="number">200</span>, <span class="comment">// 渲染loading组件前的等待时间（默认：200ms）</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">3000</span> <span class="comment">// 最长等待时间，超出则渲染error组件（默认：Infinity）</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在路由组件上使用这种写法，需要使用 vue-router 的 2.4.0 以上版本。</p>
</blockquote>
<h3 id="组件的循环引用">组件的循环引用</h3>
<p>循环引用，即两个组件互相引用对方，例如下面代码中<code>tree-folder</code>、<code>tree-folder-contents</code>两个组件同时成为了对方的父或子节点，如果使用
Webpack
模块化管理工具<code>requiring</code>/<code>importing</code>组件的时候，会报出<code>Failed to mount component: template or render function not defined.</code>错误。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; folder.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tree-folder-contents</span> <span class="attr">:children</span>=<span class="string">&quot;folder.children&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;child in children&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tree-folder</span> <span class="attr">v-if</span>=<span class="string">&quot;child.children&quot;</span> <span class="attr">:folder</span>=<span class="string">&quot;child&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span>&#123;&#123; child.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为<code>tree-folder</code>、<code>tree-folder-contents</code>相互引用对方之后，无法确定组件加载的先后顺序陷入死循环，所以需要事先指明
webpack 组件加载的优先级。解决上面例子中 Vue
组件循环引用的问题，可以在<code>tree-folder</code>组件的<code>beforeCreate()</code>生命周期函数内注册引发问题的<code>tree-folder-contents</code>组件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">beforeCreate</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">components</span>.<span class="property">TreeFolderContents</span> = <span class="built_in">require</span>(<span class="string">&quot;./tree-folder-contents.vue&quot;</span>).<span class="property">default</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="组件命名约定">组件命名约定</h3>
<p>JavaScript
中命名组件组件时可以使用<code>kebab-case</code>、<code>camelCase</code>、<code>PascalCase</code>，但
HTML 模板中只能使用<code>kebab-case</code>格式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">kebab-cased-component</span>&gt;</span><span class="tag">&lt;/<span class="name">kebab-cased-component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camel-cased-component</span>&gt;</span><span class="tag">&lt;/<span class="name">camel-cased-component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pascal-cased-component</span>&gt;</span><span class="tag">&lt;/<span class="name">pascal-cased-component</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 也可以通过自关闭方式使用组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">kebab-cased-component</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;kebab-cased-component&quot;</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;camelCasedComponent&quot;</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;PascalCasedComponent&quot;</span>: &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>推荐 JavaScript 中通过<code>PascalCase</code>方式声明组件， HTML
中则通过<code>kebab-case</code>方式使用组件。</p>
</blockquote>
<h3 id="组件递归">组件递归</h3>
<p>当局部注册的 Vue
组件递归调用自身时，需要在创建组件时添加<code>name</code>选项，全局注册的组件则可以省略该属性，因为
Vue 会自动进行添加。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 局部注册</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#my-component&quot;</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;my-component&quot;</span>,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;&lt;my-component&gt;&lt;/my-component&gt;&lt;/div&gt;&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局注册</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;my-component&quot;</span>, &#123;</span><br><span class="line">  <span class="comment">// name: &quot;my-component&quot;, 可以省略name属性</span></span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;&lt;my-component&gt;&lt;/my-component&gt;&lt;/div&gt;&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>组件递归出现死循环时，会提示<code>max stack size exceeded</code>错误，所以需要确保递归操作都拥有一个终止条件（<em>比如使用
v-if 并返回 false</em>）。</p>
</blockquote>
<h3 id="组件模板">组件模板</h3>
<ul>
<li>可以在 Vue
组件上使用<code>inline-template</code>属性，组件会将内嵌的 HTML
内容作为组件本身的模板进行渲染，而非将其作为<code>slot</code>分发的内容。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">inline-template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>These are compiled as the component&quot;s own template.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Not parent&quot;s transclusion content.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>也可以通过在<code>&lt;script&gt;</code>标签内使用<code>type="text/x-template"</code>和<code>id</code>属性来定义一个内嵌模板。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/x-template&quot;</span> <span class="attr">id</span>=<span class="string">&quot;hello-world-template&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello hello hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;hello-world&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">template</span>: <span class="string">&quot;#hello-world-template&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="vuex-状态管理">Vuex 状态管理</h2>
<p>Vuex 是专门为 Vue 应用程序提供的状态管理模式，每个 Vuex
应用的核心是<code>store</code>（<em>仓库</em>），即装载应用程序<code>state</code>（<em>状态</em>）的容器，每个应用通常只拥有一个<code>store</code>实例。</p>
<p><img src="/Web/Vue/vuex.png" title="Vuex执行流程"></p>
<p>Vuex
的<code>state</code>是响应式的，即<code>store</code>中的<code>state</code>发生变化时，相应组件也会进行更新，修改<code>store</code>当中<code>state</code>的唯一途径是提交<code>mutations</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>); <span class="comment">// 通过store.state来获取状态对象</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="property">state</span>.<span class="property">count</span>); <span class="comment">// 通过store.commit()改变状态</span></span><br></pre></td></tr></table></figure>
<h3 id="state">State</h3>
<p>从<code>store</code>当中获取<code>state</code>的最简单办法是在计算属性中返回指定的<code>state</code>，每当<code>state</code>发生改变的时候都会重新执行计算属性，并且更新关联的
DOM。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span> = &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">count</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> store.<span class="property">state</span>.<span class="property">count</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Vuex
提供<code>store</code>选项，将<code>state</code>从根组件<strong>注入</strong>到每个子组件中，从而避免频繁<code>import store</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件中注册store属性</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="attr">store</span>: store,</span><br><span class="line">  <span class="attr">components</span>: &#123; <span class="title class_">Counter</span> &#125;,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;app&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;counter&gt;&lt;/counter&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件，store会注入到子组件，子组件可通过this.$store进行访问</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span> = &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">count</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">count</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Vuex
提供<code>mapState()</code>辅助函数，避免使用多个<code>state</code>的场景下，多次去声明计算属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在单独构建的版本中辅助函数为 Vuex.mapState</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: <span class="title function_">mapState</span>(&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">count</span>,</span><br><span class="line">    <span class="comment">// 传递字符串参数&quot;count&quot;等同于`state =&gt; state.count`</span></span><br><span class="line">    <span class="attr">countAlias</span>: <span class="string">&quot;count&quot;</span>,</span><br><span class="line">    <span class="title function_">countPlusLocalState</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> + <span class="variable language_">this</span>.<span class="property">localCount</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当计算属性名称与state子节点名称相同时，可以向mapState传递一个字符串数组</span></span><br><span class="line"><span class="attr">computed</span>: <span class="title function_">mapState</span>([</span><br><span class="line">  <span class="string">&quot;count&quot;</span> <span class="comment">// 映射this.count到store.state.count</span></span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p><code>mapState()</code>函数返回一个包含有<code>state</code>相关计算属性的对象，这里可以通过
ES6 的对象展开运算符<code>...</code>将该对象与 Vue
组件本身的<code>computed</code>属性进行合并。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">localComputed</span> () &#123;&#125;,</span><br><span class="line">  ...<span class="title function_">mapState</span>(&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Vuex 允许在<code>store</code>中定义<code>getters</code>（<em>可视为
store
的计算属性</em>），<code>getters</code>的返回值会根据其依赖被缓存，只有当依赖值发生了改变才会被重新计算。该方法接收<code>state</code>作为第
1 个参数，其它<code>getters</code>作为第 2
个参数。可以直接在<code>store</code>上调用<code>getters</code>来获取指定的计算值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">todos</span>: [</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&quot;...&quot;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&quot;...&quot;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">doneTodos</span>: <span class="function">(<span class="params">state, getters</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">done</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取doneTodos = [&#123; id: 1, text: &quot;...&quot;, done: true &#125;]</span></span><br><span class="line">store.<span class="property">getters</span>.<span class="property">doneTodos</span>;</span><br></pre></td></tr></table></figure>
<p>这样就可以方便的根据<code>store</code>中现有的<code>state</code>派生出新的<code>state</code>，从而避免在多个组件中复用时造成代码冗余。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">doneTodosCount</span> () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>.<span class="property">doneTodos</span> <span class="comment">// 现在可以方便的在Vue组件使用store中定义的doneTodos</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Vuex
提供的<code>mapGetters()</code>辅助函数将<code>store</code>中的<code>getters</code>映射到局部计算属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">// 使用对象展开运算符将getters混入computed计算属性</span></span><br><span class="line">    ...<span class="title function_">mapGetters</span>([</span><br><span class="line">      <span class="string">&quot;doneTodosCount&quot;</span>,</span><br><span class="line">      (<span class="attr">doneCount</span>: <span class="string">&quot;doneTodosCount&quot;</span>) <span class="comment">// 映射store.getters.doneTodosCount到别名this.doneCount</span></span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="mutations">Mutations</h3>
<p>修改 store 中的 state 的唯一方法是提交 mutation（<em>[mjuː"teɪʃ(ə)n]
n.变化</em>），mutations
类似于自定义事件，拥有一个字符串事件类型和一个回调函数（<em>接收 state
作为参数，是对 state 进行修改的位置</em>）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="comment">// 触发类型为increment的mutation时被调用</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++; <span class="comment">// 变更状态</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触发mutation</span></span><br><span class="line">store.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>可以通过 store 的<code>commit()</code>方法触发指定的
mutations，也可以通过<code>store.commit()</code>向 mutation
传递参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commit()</span></span><br><span class="line">store.<span class="title function_">commit</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&quot;increment&quot;</span>,</span><br><span class="line">  <span class="attr">amount</span>: <span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// store</span></span><br><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">  <span class="title function_">increment</span> (state, payload) &#123;</span><br><span class="line">    state.<span class="property">count</span> += payload.<span class="property">amount</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mutation
事件类型建议使用常量，并且将这些常量放置在单独文件，便于管理和防止重复。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mutation-types.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">SOME_MUTATION</span> = <span class="string">&quot;SOME_MUTATION&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">SOME_MUTATION</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./mutation-types&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="comment">// 可以通过ES6的计算属性命名特性去使用常量作为函数名</span></span><br><span class="line">    [<span class="variable constant_">SOME_MUTATION</span>] (state) &#123;</span><br><span class="line">      <span class="comment">// mutate state</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>mutation()</code>必须是同步函数，因为 devtool
无法追踪回调函数中对<code>state</code>进行的异步修改。</p>
</blockquote>
<p>Vue 组件可以使用<code>this.$store.commit("xxx")</code>提交
mutation，或者使用<code>mapMutations()</code>将 Vue
组件中的<code>methods</code>映射为<code>store.commit</code>调用（<em>需要在根节点注入<code>store</code></em>）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapMutations</span>([</span><br><span class="line">      <span class="string">&quot;increment&quot;</span> <span class="comment">// 映射this.increment()为this.$store.commit(&quot;increment&quot;)</span></span><br><span class="line">    ]),</span><br><span class="line">    ...<span class="title function_">mapMutations</span>(&#123;</span><br><span class="line">      <span class="attr">add</span>: <span class="string">&quot;increment&quot;</span> <span class="comment">// 映射this.add()为this.$store.commit(&quot;increment&quot;)</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="actions">Actions</h3>
<p>Action 用来提交 mutation，且 Action 中可以包含异步操作。Action
函数接受一个与 store
实例具有相同方法和属性的<code>context</code>对象，因此可以通过调用<code>context.commit</code>提交一个
mutation，或者通过<code>context.state</code>和<code>context.getters</code>来获取
state、getters。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">context</span>) &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>生产环境下，可以通过 ES6 的解构参数来简化代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="comment">// 直接向action传递commit方法</span></span><br><span class="line">  <span class="title function_">increment</span> (&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Action
通过<code>store.dispatch()</code>方法进行分发，<strong>mutation</strong>当中只能进行<strong>同步</strong>操作，而<strong>action</strong>内部可以进行<strong>异步</strong>的操作。下面是一个购物车的例子，代码中分发了多个
mutations，并进行了异步 API 操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="title function_">checkout</span> (&#123; commit, state &#125;, products) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> savedCartItems = [...state.<span class="property">cart</span>.<span class="property">added</span>]  <span class="comment">// 把当前购物车的物品备份起来</span></span><br><span class="line">    <span class="title function_">commit</span>(types.<span class="property">CHECKOUT_REQUEST</span>)                <span class="comment">// 发出结账请求，然后清空购物车</span></span><br><span class="line">    <span class="comment">// 购物Promise分别接收成功和失败的回调</span></span><br><span class="line">    shop.<span class="title function_">buyProducts</span>(</span><br><span class="line">      products,</span><br><span class="line">      <span class="function">() =&gt;</span> <span class="title function_">commit</span>(types.<span class="property">CHECKOUT_SUCCESS</span>),                  <span class="comment">// 成功操作</span></span><br><span class="line">      <span class="function">() =&gt;</span> <span class="title function_">commit</span>(types.<span class="property">CHECKOUT_FAILURE</span>, savedCartItems)   <span class="comment">// 失败操作</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>组件中可以使用<code>this.$store.dispatch("xxx")</code>分发
action，或者使用<code>mapActions()</code>将组件的<code>methods</code>映射为<code>store.dispatch</code>（<em>需要在根节点注入<code>store</code></em>）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapActions</span>([</span><br><span class="line">      <span class="string">&quot;increment&quot;</span> <span class="comment">// 映射this.increment()为this.$store.dispatch(&quot;increment&quot;)</span></span><br><span class="line">    ]),</span><br><span class="line">    ...<span class="title function_">mapActions</span>(&#123;</span><br><span class="line">      <span class="attr">add</span>: <span class="string">&quot;increment&quot;</span> <span class="comment">// 映射this.add()为this.$store.dispatch(&quot;increment&quot;)</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>store.dispatch</code>可以处理<code>action</code>回调函数当中返回的<code>Promise</code>，并且<code>store.dispatch</code>本身仍然返回一个<code>Promise</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="comment">// 定义一个返回Promise对象的actionA</span></span><br><span class="line">  <span class="title function_">actionA</span> (&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">commit</span>(<span class="string">&quot;someMutation&quot;</span>) <span class="comment">// 触发mutation</span></span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 也可以在actionB中分发actionA</span></span><br><span class="line">  <span class="title function_">actionB</span> (&#123; dispatch, commit &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">dispatch</span>(<span class="string">&quot;actionA&quot;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">commit</span>(<span class="string">&quot;someOtherMutation&quot;</span>) <span class="comment">// 触发另外一个mutation</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在可以分发actionA</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="string">&quot;actionA&quot;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  ... ... ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>可以体验通过 ES7
的异步处理特性<code>async</code>/<code>await</code>来组合 action。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">actionA</span> (&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;gotData&quot;</span>, <span class="keyword">await</span> <span class="title function_">getData</span>())</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">actionB</span> (&#123; dispatch, commit &#125;) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">dispatch</span>(<span class="string">&quot;actionA&quot;</span>) <span class="comment">//等待actionA完成</span></span><br><span class="line">    <span class="title function_">commit</span>(<span class="string">&quot;gotOtherData&quot;</span>, <span class="keyword">await</span> <span class="title function_">getOtherData</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="module">Module</h3>
<p>整个应用使用单一状态树的情况下，所有 state 都会集中到一个 store
对象，因此 store 可能变得非常臃肿。因此，Vuex 允许将 store
切割成模块（<em>module</em>），每个模块拥有自己的<code>state</code>、<code>mutation</code>、<code>action</code>、<code>getter</code>、甚至是嵌套的子模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">a</span>: moduleA,</span><br><span class="line">    <span class="attr">b</span>: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="property">state</span>.<span class="property">a</span>; <span class="comment">// moduleA的状态</span></span><br><span class="line">store.<span class="property">state</span>.<span class="property">b</span>; <span class="comment">// moduleB的状态</span></span><br></pre></td></tr></table></figure>
<p>module 内部的<code>mutations()</code>和<code>getters()</code>接收的第
1 个参数是模块的局部状态对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">state</span>: &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++; <span class="comment">// 这里的state是模块的局部状态</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">doubleCount</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> * <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>模块内部 action
当中，可以通过<code>context.state</code>获取局部状态，以及<code>context.rootState</code>获取全局状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">incrementIfOddOnRootSum</span>(<span class="params">&#123; state, commit, rootState &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((state.<span class="property">count</span> + rootState.<span class="property">count</span>) % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>模块内部的<code>getters()</code>方法，可以通过其第 3
个参数接收到全局状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">sumWithRootCount</span>(<span class="params">state, getters, rootState</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> + rootState.<span class="property">count</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="严格模式">严格模式</h3>
<p>严格模式下，如果 state
变化不是由<code>mutation()</code>函数引起，将会抛出错误。只需要在创建<code>store</code>的时候传入<code>strict: true</code>即可开启严格模式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">strict</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>不要在生产环境下启用严格模式，因为它会深度检测不合法的 state
变化，从而造成不必要的性能损失，我们可以通过在构建工具中增加如下判断避免这种情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">strict</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>严格模式下，在属于 Vuex 的 state 上使用 v-model
指令会抛出错误，此时需要手动绑定 value 并监听 input、change
事件，并在事件回调中手动提交
action。另外一种实现方式是直接重写计算属性的 get 和 set 方法。</p>
</blockquote>
<h3 id="总结">总结</h3>
<ol type="1">
<li>应用层级的状态应该集中到<strong>单个 store 对象</strong>中。</li>
<li>提交<code>mutation</code>是更改状态的唯一方法，并且这个过程是<strong>同步</strong>的。</li>
<li><strong>异步</strong>逻辑都应该封装到<code>action</code>里面。</li>
</ol>
<h2 id="webpack-vue-loader">Webpack Vue Loader</h2>
<p><a target="_blank" rel="noopener" href="https://vue-loader.vuejs.org/en/">vue-loader</a>是由 Vue
开源社区提供的 Webpack
加载器，用来将<code>.vue</code>后缀的单文件组件转换为 JavaScript
模块，每个<code>.vue</code>单文件组件可以包括以下部分：</p>
<ol type="1">
<li>一个<code>&lt;template&gt;</code>。</li>
<li>一个<code>&lt;script&gt;</code>。</li>
<li>多个<code>&lt;style&gt;</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span>只能有1个<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  只能有1个;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  可以有多个</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  可以有多个</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  可以有多个</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="css-作用域">CSS 作用域</h3>
<p>向<code>.vue</code>单文件组件的<code>&lt;style&gt;</code>标签上添加<code>scoped</code>属性，可以让该<code>&lt;style&gt;</code>标签中的样式只作用于当前组件。使用
scoped 时，样式选择器尽量使用 class 或者 id，以提升页面渲染性能。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 单文件组件定义 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.example</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;example&quot;</span>&gt;</span>Hank<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 转换结果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.example</span><span class="selector-attr">[data-v-f3f3eg9]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;example&quot;</span> <span class="attr">data-v-f3f3eg9</span>&gt;</span>Hank<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以在一个组件中同时使用带<code>scoped</code>属性和不带该属性的<code>&lt;style/&gt;</code>，分别用来定义组件私有样式和全局样式。</p>
</blockquote>
<h3 id="css-模块化">CSS 模块化</h3>
<p>在单文件组件<code>.vue</code>的<code>&lt;style&gt;</code>标签上添加<code>module</code>属性即可打开
CSS 模块化特性。<a target="_blank" rel="noopener" href="https://github.com/css-modules/css-modules">CSS
Modules</a>用于模块化组合 CSS，<a target="_blank" rel="noopener" href="https://vue-loader.vuejs.org/en/features/css-modules.html">vue-loader</a>已经集成了
CSS 模块化特性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">module</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.red</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.bold</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>CSS 模块会向 Vue
组件中注入名为<code>$style</code>计算属性，从而实现在组件的<code>&lt;template/&gt;</code>中使用动态的<code>class</code>属性进行绑定。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">&quot;$style.red&quot;</span>&gt;</span></span><br><span class="line">    This should be red</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="动画">动画</h2>
<p>Vue
在插入、更新、移除<strong>DOM</strong>的时候，提供了如下几种方式去展现进入（<em>entering</em>）和离开（<em>leaving</em>）的过渡效果。</p>
<ol type="1">
<li>在 CSS 过渡和动画中应用 class。</li>
<li>钩子过渡函数中直接操作 DOM。</li>
<li>使用 CSS、JavaScript 动画库，如<a target="_blank" rel="noopener" href="https://daneden.github.io/animate.css/">Animate.css</a>、<a target="_blank" rel="noopener" href="http://velocityjs.org/">Velocity.js</a>。</li>
</ol>
<h3 id="transition-组件">transition 组件</h3>
<p>Vue 提供了内置组件<code>&lt;transition/&gt;</code>来为 HTML 元素、Vue
组件添加过渡动画效果，可以在<em>条件展示</em>（<em>使用<code>v-if</code>或<code>v-show</code></em>）、<em>动态组件</em>、<em>展示组件根节点</em>的情况下进行渲染。<code>&lt;transition/&gt;</code>主要用来处理单个节点，或者同时渲染多个节点当中的一个。</p>
<h4 id="自动切换的-class-类名">自动切换的 class 类名</h4>
<p>在组件或 HTML
进入（<em>entering</em>）和离开（<em>leaving</em>）的过渡效果当中，Vue
将会自动切换并应用下图中的六种 class 类名。</p>
<p><img src="/Web/Vue/transition.png" title="过渡效果自动切换的class"></p>
<p>可以使用<code>&lt;transition/&gt;</code>的<code>name</code>属性来自动生成过渡
class
类名，例如下面例子中的<code>name: "fade"</code>将自动拓展为<code>.fade-enter</code>，<code>.fade-enter-active</code>等，<code>name</code>属性缺省的情况下默认类名为<code>v</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;show = !show&quot;</span>&gt;</span>Toggle<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;show&quot;</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#demo&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.fade-enter-active</span>,</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.fade-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: opacity <span class="number">0.5s</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.fade-enter</span>,</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.fade-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义-css-类名">自定义 CSS 类名</h4>
<p>结合<code>Animate.css</code>使用时，可以在<code>&lt;transition/&gt;</code>当中通过以下属性自定义
class 类名。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">enter-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">enter-active-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">enter-to-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">leave-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">leave-active-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">leave-to-class</span>=<span class="string">&quot;animated&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义-javascript-钩子">自定义 JavaScript 钩子</h4>
<p>结合<code>Velocity.js</code>使用时，通过 v-on
在属性中设置钩子函数。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:before-enter</span>=<span class="string">&quot;beforeEnter&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:enter</span>=<span class="string">&quot;enter&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:after-enter</span>=<span class="string">&quot;afterEnter&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:enter-cancelled</span>=<span class="string">&quot;enterCancelled&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:before-leave</span>=<span class="string">&quot;beforeLeave&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:leave</span>=<span class="string">&quot;leave&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:after-leave</span>=<span class="string">&quot;afterLeave&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:leave-cancelled</span>=<span class="string">&quot;leaveCancelled&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// ...</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">beforeEnter</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">enter</span>: <span class="keyword">function</span> (<span class="params">el, done</span>) &#123; <span class="title function_">done</span>() &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">afterEnter</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">enterCancelled</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">beforeLeave</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">leave</span>: <span class="keyword">function</span> (<span class="params">el, done</span>) &#123; <span class="title function_">done</span>() &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">afterLeave</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">leaveCancelled</span>: <span class="keyword">function</span> (<span class="params">el</span>) &#123;&#125; <span class="comment">// 仅用于v-show</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="显式设置过渡持续时间">显式设置过渡持续时间</h4>
<p>可以使用<code>&lt;transition&gt;</code>上的<code>duration属性</code>设置一个以毫秒为单位的显式过渡持续时间。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">:duration</span>=<span class="string">&quot;1000&quot;</span>&gt;</span> Hank <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 可以分别定制进入、移出的持续时间 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">:duration</span>=<span class="string">&quot;&#123; enter: 500, leave: 800 &#125;&quot;</span>&gt;</span> Hank <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="组件首次渲染时的过渡">组件首次渲染时的过渡</h4>
<p>通过<code>&lt;transition&gt;</code>上的<code>appear属性</code>设置组件节点首次被渲染时的过渡动画。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自定义CSS类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">appear</span></span></span><br><span class="line"><span class="tag">  <span class="attr">appear-class</span>=<span class="string">&quot;custom-appear-class&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">appear-to-class</span>=<span class="string">&quot;custom-appear-to-class&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">appear-active-class</span>=<span class="string">&quot;custom-appear-active-class&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自定义JavaScript钩子 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">appear</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:before-appear</span>=<span class="string">&quot;customBeforeAppearHook&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:appear</span>=<span class="string">&quot;customAppearHook&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:after-appear</span>=<span class="string">&quot;customAfterAppearHook&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:appear-cancelled</span>=<span class="string">&quot;customAppearCancelledHook&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="html-元素的过渡效果">HTML 元素的过渡效果</h4>
<h5 id="vue-组件的-key-属性">Vue 组件的 key 属性</h5>
<p>key 属性主要用在 Vue 虚拟 DOM 算法中去区分新旧
VNodes，不显式使用<code>key</code>的时候，Vue
会使用性能最优的自动比较算法。显式的使用<code>key</code>，则会基于<code>key</code>的变化重新排列元素顺序，并移除不存在<code>key</code>的元素。具有相同父元素的子元素必须有独特的<code>key</code>，因为重复的<code>key</code>会造成渲染错误。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 最常见的用法是在使用v-for的时候 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in items&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="元素的的交替过渡">元素的的交替过渡</h5>
<p>可以通过 Vue
提供的<code>v-if</code>和<code>v-else</code>属性来实现多组件的交替过渡，最常见的过渡效果是一个列表以及描述列表为空时的消息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">v-if</span>=<span class="string">&quot;items.length &gt; 0&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>Sorry, no items found.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Vue
中具有相同名称的元素切换时，需要通过关键字<code>key</code>作为标记进行区分，否则
Vue
出于效率的考虑只会替换相同标签内的内容，因此为<code>&lt;transition&gt;</code>组件中的同名元素设置<code>key</code>是一个<strong>最佳实践</strong>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> <span class="attr">key</span>=<span class="string">&quot;save&quot;</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else</span> <span class="attr">key</span>=<span class="string">&quot;edit&quot;</span>&gt;</span>Edit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>一些场景中，可以通过给相同 HTML
元素的<code>key</code>属性设置不同的状态来代替冗长的<code>v-if</code>和<code>v-else</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过v-if和v-else来实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> <span class="attr">key</span>=<span class="string">&quot;save&quot;</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else</span> <span class="attr">key</span>=<span class="string">&quot;edit&quot;</span>&gt;</span>Edit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 设置动态的key属性来实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-bind:key</span>=<span class="string">&quot;isEditing&quot;</span>&gt;</span>&#123;&#123; isEditing ? &quot;Save&quot; : &quot;Edit&quot; &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>而对于使用了多个<code>v-if</code>的多元素过渡，也可以通过动态的<code>key</code>属性进行大幅度的简化。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 多个v-if实现的多元素过渡 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">saved</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;saved&quot;</span>&gt;</span> Edit <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">edited</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;edited&quot;</span>&gt;</span> Save <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">editing</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;editing&quot;</span>&gt;</span> Cancel <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 通过动态key属性可以大幅简化模板代码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-bind:key</span>=<span class="string">&quot;docState&quot;</span>&gt;</span> &#123;&#123; buttonMessage &#125;&#125; <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">...</span></span><br><span class="line"><span class="language-javascript"><span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">buttonMessage</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">docState</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&quot;saved&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;Edit&quot;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&quot;edited&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;Save&quot;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&quot;editing&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;Cancel&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="vue-组件的过渡效果">Vue 组件的过渡效果</h4>
<p>多个 Vue
组件之间的过渡不需要使用<code>key</code>属性，只需要使用<strong>动态组件</strong>即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;component-fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">new Vue(&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  el: &quot;#transition-components-demo&quot;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  data: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    view: &quot;v-a&quot;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  &#125;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  components: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    &quot;v-a&quot;: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">      template: &quot;<span class="tag">&lt;<span class="name">div</span>&gt;</span>Component A<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&quot;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    &#125;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    &quot;v-b&quot;: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">      template: &quot;<span class="tag">&lt;<span class="name">div</span>&gt;</span>Component B<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&quot;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"></span></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"><span class="selector-class">.component-fade-enter-active</span>, <span class="selector-class">.component-fade-leave-active</span> &#123;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars">  <span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars">&#125;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars"><span class="selector-class">.component-fade-enter</span>, <span class="selector-class">.component-fade-leave-to</span> &#123;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars">&#125;</span></span></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="language-handlebars">&lt;style&gt;</span></span></span></span></span></span><br></pre></td></tr></table></figure>
<h4 id="选择-html-元素或-vue-组件的过渡模式">选择 HTML 元素或 Vue
组件的过渡模式</h4>
<p><code>&lt;transition&gt;</code>的默认进入（<em>enter</em>）和离开（<em>leave</em>）行为同时发生，所以当多个需要切换显示的
HTML 元素或 Vue
组件处于相同位置的时候，这种同时生效的进入和离开过渡不能满足所有需求，Vue
可以通过<code>&lt;transition-gruop&gt;</code>组件的<code>mode</code>属性来选择如下过渡模式。</p>
<ul>
<li><code>in-out</code>：新元素先进行过渡，完成之后当前显示的元素再过渡离开。</li>
<li><code>out-in</code>：当前显示的元素先进行过渡，完成之后新元素再过渡进入。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">saved</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;saved&quot;</span>&gt;</span> Edit <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">edited</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;edited&quot;</span>&gt;</span> Save <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &quot;</span><span class="attr">editing</span>&quot;&quot; <span class="attr">key</span>=<span class="string">&quot;editing&quot;</span>&gt;</span> Cancel <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="transition-group-组件">transition-group 组件</h3>
<p><code>&lt;transition-group&gt;</code>用来设置多个 HTML 元素或 Vue
组件的过渡效果，不同于<code>&lt;transition&gt;</code>，该组件默认会被渲染为一个真实的<code>&lt;span&gt;</code>元素，但是开发人员也可以通过<code>&lt;transition-group&gt;</code>组件的<code>tag</code>属性更换为其它合法的
HTML
元素。<code>&lt;transition-group&gt;</code>组件内部的元素必须要提供唯一的<code>key</code>属性值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list-demo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>Add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;remove&quot;</span>&gt;</span>Remove<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span> <span class="attr">tag</span>=<span class="string">&quot;p&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-for</span>=<span class="string">&quot;item in items&quot;</span> <span class="attr">v-bind:key</span>=<span class="string">&quot;item&quot;</span> <span class="attr">class</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#list-demo&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">items</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">nextNum</span>: <span class="number">10</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">randomIndex</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable language_">this</span>.<span class="property">items</span>.<span class="property">length</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">add</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">splice</span>(<span class="variable language_">this</span>.<span class="title function_">randomIndex</span>(), <span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">nextNum</span>++);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">remove</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">splice</span>(<span class="variable language_">this</span>.<span class="title function_">randomIndex</span>(), <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.list-item</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.list-enter-active</span>,</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.list-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: all <span class="number">1s</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.list-enter</span>,</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.list-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">30px</span>);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;transition-group&gt;</code>实现的列表过渡效果在添加、移除某个
HTML 元素时，相临的其它 HTML
元素会瞬间移动至新位置，这个过程并非平滑的过渡。为解决这个问题，<code>&lt;transition-group&gt;</code>提供<em>v-move</em>特性去覆盖<strong>移动过渡期间</strong>所使用的
CSS
类名。开启该特性，即可以通过<code>name</code>属性手动设置（<em>下面例子中的<code>name="flip-list"</code>与<code>.flip-list-move</code></em>），也可以直接使用<code>move-class</code>属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;flip-list-demo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;shuffle&quot;</span>&gt;</span>Shuffle<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">name</span>=<span class="string">&quot;flip-list&quot;</span> <span class="attr">tag</span>=<span class="string">&quot;ul&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in items&quot;</span> <span class="attr">v-bind:key</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">el</span>: <span class="string">&quot;#flip-list-demo&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">items</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">shuffle</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">items</span> = _.<span class="title function_">shuffle</span>(<span class="variable language_">this</span>.<span class="property">items</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.flip-list-move</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: transform <span class="number">1s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&lt;style&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以通过<strong>响应式</strong>的绑定<code>&lt;transition&gt;</code>和<code>&lt;transition-gruop&gt;</code>上的
name 属性，从而能够根据组件自身的状态实现具有动态性的过渡效果。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">v-bind:name</span>=<span class="string">&quot;transitionName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>Vue 2 技术栈归纳与精粹</p><p><a href="http://www.uinio.com/Web/Vue/">http://www.uinio.com/Web/Vue/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hank</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2016-11-27</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2017-05-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/JavaScript/">JavaScript</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Web/React/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">React 16.6.x 全新全译</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Other/2016-Chengdu-Realestate/"><span class="level-item">2016 年，成都房价上涨对城南 IT 产业的影响与思考</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#vue-与-angular-的比较"><span class="level-left"><span class="level-item">1</span><span class="level-item">Vue 与 Angular 的比较</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#组件化"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">组件化</span></span></a></li><li><a class="level is-mobile" href="#双向绑定与响应式绑定"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">双向绑定与响应式绑定</span></span></a></li><li><a class="level is-mobile" href="#object.defineproperty"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Object.defineProperty()</span></span></a></li><li><a class="level is-mobile" href="#虚拟-dom"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">虚拟 DOM</span></span></a></li></ul></li><li><a class="level is-mobile" href="#vue-对象的选项"><span class="level-left"><span class="level-item">2</span><span class="level-item">Vue 对象的选项</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#属性计算-computed"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">属性计算 computed</span></span></a></li><li><a class="level is-mobile" href="#观察者属性-watch"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">观察者属性 watch</span></span></a></li><li><a class="level is-mobile" href="#混合属性-mixins"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">混合属性 mixins</span></span></a></li><li><a class="level is-mobile" href="#渲染函数-render"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">渲染函数 render()</span></span></a></li></ul></li><li><a class="level is-mobile" href="#vue-对象全局-api"><span class="level-left"><span class="level-item">3</span><span class="level-item">Vue 对象全局 API</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#vue.mixinmixin"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Vue.mixin(mixin)</span></span></a></li><li><a class="level is-mobile" href="#vue.directiveid-definition"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Vue.directive(id, [definition])</span></span></a></li><li><a class="level is-mobile" href="#vue.filterid-definition"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Vue.filter(id, [definition])</span></span></a></li><li><a class="level is-mobile" href="#vue.useplugin"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">Vue.use(plugin)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#实例属性和方法"><span class="level-left"><span class="level-item">4</span><span class="level-item">实例属性和方法</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#refs-属性"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">$refs 属性</span></span></a></li></ul></li><li><a class="level is-mobile" href="#生命周期"><span class="level-left"><span class="level-item">5</span><span class="level-item">生命周期</span></span></a></li><li><a class="level is-mobile" href="#数据绑定"><span class="level-left"><span class="level-item">6</span><span class="level-item">数据绑定</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#绑定-html-的-class-和-style"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">绑定 HTML 的 class 和 style</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#v-bindclass"><span class="level-left"><span class="level-item">6.1.1</span><span class="level-item">v-bind:class</span></span></a></li><li><a class="level is-mobile" href="#v-bindstyle"><span class="level-left"><span class="level-item">6.1.2</span><span class="level-item">v-bind:style</span></span></a></li></ul></li><li><a class="level is-mobile" href="#使用-javascript-表达式"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">使用 JavaScript 表达式</span></span></a></li><li><a class="level is-mobile" href="#v-model-双向数据绑定"><span class="level-left"><span class="level-item">6.3</span><span class="level-item">v-model 双向数据绑定</span></span></a></li></ul></li><li><a class="level is-mobile" href="#内置指令"><span class="level-left"><span class="level-item">7</span><span class="level-item">内置指令</span></span></a></li><li><a class="level is-mobile" href="#组件"><span class="level-left"><span class="level-item">8</span><span class="level-item">组件</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#props"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">props</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#命名方式转换"><span class="level-left"><span class="level-item">8.1.1</span><span class="level-item">命名方式转换</span></span></a></li><li><a class="level is-mobile" href="#动态-props"><span class="level-left"><span class="level-item">8.1.2</span><span class="level-item">动态 props</span></span></a></li><li><a class="level is-mobile" href="#验证-props"><span class="level-left"><span class="level-item">8.1.3</span><span class="level-item">验证 props</span></span></a></li><li><a class="level is-mobile" href="#组件的非-props-属性"><span class="level-left"><span class="level-item">8.1.4</span><span class="level-item">组件的非 props 属性</span></span></a></li></ul></li><li><a class="level is-mobile" href="#事件"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">事件</span></span></a></li><li><a class="level is-mobile" href="#slot"><span class="level-left"><span class="level-item">8.3</span><span class="level-item">slot</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#匿名插槽"><span class="level-left"><span class="level-item">8.3.1</span><span class="level-item">匿名插槽</span></span></a></li><li><a class="level is-mobile" href="#具名插槽"><span class="level-left"><span class="level-item">8.3.2</span><span class="level-item">具名插槽</span></span></a></li><li><a class="level is-mobile" href="#作用域插槽"><span class="level-left"><span class="level-item">8.3.3</span><span class="level-item">作用域插槽</span></span></a></li></ul></li><li><a class="level is-mobile" href="#函数化组件"><span class="level-left"><span class="level-item">8.4</span><span class="level-item">函数化组件</span></span></a></li><li><a class="level is-mobile" href="#动态组件"><span class="level-left"><span class="level-item">8.5</span><span class="level-item">动态组件</span></span></a></li><li><a class="level is-mobile" href="#组件异步加载"><span class="level-left"><span class="level-item">8.6</span><span class="level-item">组件异步加载</span></span></a></li><li><a class="level is-mobile" href="#组件的循环引用"><span class="level-left"><span class="level-item">8.7</span><span class="level-item">组件的循环引用</span></span></a></li><li><a class="level is-mobile" href="#组件命名约定"><span class="level-left"><span class="level-item">8.8</span><span class="level-item">组件命名约定</span></span></a></li><li><a class="level is-mobile" href="#组件递归"><span class="level-left"><span class="level-item">8.9</span><span class="level-item">组件递归</span></span></a></li><li><a class="level is-mobile" href="#组件模板"><span class="level-left"><span class="level-item">8.10</span><span class="level-item">组件模板</span></span></a></li></ul></li><li><a class="level is-mobile" href="#vuex-状态管理"><span class="level-left"><span class="level-item">9</span><span class="level-item">Vuex 状态管理</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#state"><span class="level-left"><span class="level-item">9.1</span><span class="level-item">State</span></span></a></li><li><a class="level is-mobile" href="#mutations"><span class="level-left"><span class="level-item">9.2</span><span class="level-item">Mutations</span></span></a></li><li><a class="level is-mobile" href="#actions"><span class="level-left"><span class="level-item">9.3</span><span class="level-item">Actions</span></span></a></li><li><a class="level is-mobile" href="#module"><span class="level-left"><span class="level-item">9.4</span><span class="level-item">Module</span></span></a></li><li><a class="level is-mobile" href="#严格模式"><span class="level-left"><span class="level-item">9.5</span><span class="level-item">严格模式</span></span></a></li><li><a class="level is-mobile" href="#总结"><span class="level-left"><span class="level-item">9.6</span><span class="level-item">总结</span></span></a></li></ul></li><li><a class="level is-mobile" href="#webpack-vue-loader"><span class="level-left"><span class="level-item">10</span><span class="level-item">Webpack Vue Loader</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#css-作用域"><span class="level-left"><span class="level-item">10.1</span><span class="level-item">CSS 作用域</span></span></a></li><li><a class="level is-mobile" href="#css-模块化"><span class="level-left"><span class="level-item">10.2</span><span class="level-item">CSS 模块化</span></span></a></li></ul></li><li><a class="level is-mobile" href="#动画"><span class="level-left"><span class="level-item">11</span><span class="level-item">动画</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#transition-组件"><span class="level-left"><span class="level-item">11.1</span><span class="level-item">transition 组件</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#自动切换的-class-类名"><span class="level-left"><span class="level-item">11.1.1</span><span class="level-item">自动切换的 class 类名</span></span></a></li><li><a class="level is-mobile" href="#自定义-css-类名"><span class="level-left"><span class="level-item">11.1.2</span><span class="level-item">自定义 CSS 类名</span></span></a></li><li><a class="level is-mobile" href="#自定义-javascript-钩子"><span class="level-left"><span class="level-item">11.1.3</span><span class="level-item">自定义 JavaScript 钩子</span></span></a></li><li><a class="level is-mobile" href="#显式设置过渡持续时间"><span class="level-left"><span class="level-item">11.1.4</span><span class="level-item">显式设置过渡持续时间</span></span></a></li><li><a class="level is-mobile" href="#组件首次渲染时的过渡"><span class="level-left"><span class="level-item">11.1.5</span><span class="level-item">组件首次渲染时的过渡</span></span></a></li><li><a class="level is-mobile" href="#html-元素的过渡效果"><span class="level-left"><span class="level-item">11.1.6</span><span class="level-item">HTML 元素的过渡效果</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#vue-组件的-key-属性"><span class="level-left"><span class="level-item">11.1.6.1</span><span class="level-item">Vue 组件的 key 属性</span></span></a></li><li><a class="level is-mobile" href="#元素的的交替过渡"><span class="level-left"><span class="level-item">11.1.6.2</span><span class="level-item">元素的的交替过渡</span></span></a></li></ul></li><li><a class="level is-mobile" href="#vue-组件的过渡效果"><span class="level-left"><span class="level-item">11.1.7</span><span class="level-item">Vue 组件的过渡效果</span></span></a></li><li><a class="level is-mobile" href="#选择-html-元素或-vue-组件的过渡模式"><span class="level-left"><span class="level-item">11.1.8</span><span class="level-item">选择 HTML 元素或 Vue
组件的过渡模式</span></span></a></li></ul></li><li><a class="level is-mobile" href="#transition-group-组件"><span class="level-left"><span class="level-item">11.2</span><span class="level-item">transition-group 组件</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C-C-%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">C/C++ 语言</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">Linux 操作系统</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Python-%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">Python 语言</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/UINIO-%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E8%B5%84%E6%96%99/"><span class="level-start"><span class="level-item">UINIO 开源项目资料</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Web-%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">Web 开发</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BA%A7%E4%B8%9A%E7%BB%8F%E6%B5%8E/"><span class="level-start"><span class="level-item">产业经济</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%96%E8%A7%82%E4%B8%8E%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">外观与结构设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/"><span class="level-start"><span class="level-item">嵌入式</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%9B%BA%E4%BB%B6/"><span class="level-start"><span class="level-item">嵌入式固件</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">开发环境配置</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"><span class="level-start"><span class="level-item">版本管理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"><span class="level-start"><span class="level-item">生活日常</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">硬件电子技术</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">算法</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%8B%B1%E8%AF%AD/"><span class="level-start"><span class="level-item">英语</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">软件工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Cadence-Skill/"><img src="/Electronics/Cadence-Skill/logo.png" alt="Cadence SPB OrCAD/Allegro 17.4 进阶技巧总结"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-09T16:00:00.000Z">2025-06-10</time></p><p class="title"><a href="/Electronics/Cadence-Skill/">Cadence SPB OrCAD/Allegro 17.4 进阶技巧总结</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/CAN/"><img src="/Electronics/CAN/logo.png" alt="控制器区域网络 CAN 总线协议图解"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-04-30T16:00:00.000Z">2025-05-01</time></p><p class="title"><a href="/Electronics/CAN/">控制器区域网络 CAN 总线协议图解</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Embedded/FOC/"><img src="/Embedded/FOC/logo.png" alt="剖析无刷电机的 FOC 磁场定向控制算法"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-04-14T16:00:00.000Z">2025-04-15</time></p><p class="title"><a href="/Embedded/FOC/">剖析无刷电机的 FOC 磁场定向控制算法</a></p><p class="categories"><a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Power-Switching/"><img src="/Electronics/Power-Switching/logo.png" alt="开关电源 SMPS 基本原理 &amp; 拓扑结构剖析"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-03-05T16:00:00.000Z">2025-03-06</time></p><p class="title"><a href="/Electronics/Power-Switching/">开关电源 SMPS 基本原理 &amp; 拓扑结构剖析</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Embedded/PID/"><img src="/Embedded/PID/logo.png" alt="闭环控制算法 PID 的原理剖析与实现"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-02-04T16:00:00.000Z">2025-02-05</time></p><p class="title"><a href="/Embedded/PID/">闭环控制算法 PID 的原理剖析与实现</a></p><p class="categories"><a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CAD/"><span class="tag">CAD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDA/"><span class="tag">EDA</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GCC-GDB/"><span class="tag">GCC/GDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTML/"><span class="tag">HTML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LaTeX/"><span class="tag">LaTeX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MCU/"><span class="tag">MCU</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Make/"><span class="tag">Make</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Markdown/"><span class="tag">Markdown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PCB/"><span class="tag">PCB</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python3/"><span class="tag">Python3</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Qt/"><span class="tag">Qt</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shell/"><span class="tag">Shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Solidity/"><span class="tag">Solidity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tools/"><span class="tag">Tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E6%95%B0/"><span class="tag">代数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%BF%E7%9C%9F/"><span class="tag">仿真</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%83%E5%99%A8%E4%BB%B6/"><span class="tag">元器件</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"><span class="tag">命令行</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"><span class="tag">密码学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%84%E9%A2%91/"><span class="tag">射频</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F-Linux/"><span class="tag">嵌入式 Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"><span class="tag">开发规范</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/"><span class="tag">微积分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%80%BB%E7%BA%BF/"><span class="tag">总线</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%89%8B%E6%9C%BA/"><span class="tag">手机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6%E7%BB%93%E6%9E%84/"><span class="tag">数学结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%B0%E6%A6%82%E5%BF%B5%E8%8B%B1%E8%AF%AD/"><span class="tag">新概念英语</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"><span class="tag">服务器</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%82%E8%B0%88/"><span class="tag">杂谈</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%BD%E8%BD%A6/"><span class="tag">汽车</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E5%AD%90%E4%BB%AA%E5%99%A8/"><span class="tag">电子仪器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%9C%BA/"><span class="tag">电机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%BA%90/"><span class="tag">电源</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E8%B7%AF%E7%90%86%E8%AE%BA/"><span class="tag">电路理论</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"><span class="tag">网络协议</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%AD%E6%B3%95/"><span class="tag">语法</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv" style="display:inline-block;margin:auto 0.5rem;">0</span>个访客</span></p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img src="/images/ICP.png"> 蜀 ICP 备 2021027760 号</a><p class="is-size-7">Copyright © 2025 <span>UinIO 电子技术实验室</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://unpkg.com/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://unpkg.com/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://unpkg.com/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://unpkg.com/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://unpkg.com/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script src="/js/math.js"></script><script id="MathJax-script" async src="/js/es5/tex-mml-chtml.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>