<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>编码实践当中涉及的密码学知识 - UinIO.com 电子技术实验室</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UinIO.com 电子技术实验室"><meta name="msapplication-TileImage" content="/images/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UinIO.com 电子技术实验室"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="OpenSSL 是用于安全传输层（TLS，Transport Layer Security）协议和安全套接字层（SSL，Secure Sockets Layer）协议的的工具包，提供了 SSL 协议实现（SSLv2、SSLv3、TLSv1）、大量算法实现（对称&amp;#x2F;非对称&amp;#x2F;摘要）、大数运算、非对称算法密钥、ASN.1 编解码库、证书请求（PKCS10）编解码、数字证书编解码、CRL 编解码"><meta property="og:type" content="blog"><meta property="og:title" content="编码实践当中涉及的密码学知识"><meta property="og:url" content="http://www.uinio.com/Zen/Cryptology/"><meta property="og:site_name" content="UinIO.com 电子技术实验室"><meta property="og:description" content="OpenSSL 是用于安全传输层（TLS，Transport Layer Security）协议和安全套接字层（SSL，Secure Sockets Layer）协议的的工具包，提供了 SSL 协议实现（SSLv2、SSLv3、TLSv1）、大量算法实现（对称&amp;#x2F;非对称&amp;#x2F;摘要）、大数运算、非对称算法密钥、ASN.1 编解码库、证书请求（PKCS10）编解码、数字证书编解码、CRL 编解码"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.uinio.com/images/favicon.png"><meta property="article:published_time" content="2021-08-09T16:00:00.000Z"><meta property="article:modified_time" content="2021-08-12T16:00:00.000Z"><meta property="article:author" content="Hank"><meta property="article:tag" content="Encrypt"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://www.uinio.com/images/favicon.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.uinio.com/Zen/Cryptology/"},"headline":"编码实践当中涉及的密码学知识","image":["http://www.uinio.com/Zen/Cryptology/logo.png"],"datePublished":"2021-08-09T16:00:00.000Z","dateModified":"2021-08-12T16:00:00.000Z","author":{"@type":"Person","name":"Hank"},"publisher":{"@type":"Organization","name":"UinIO.com 电子技术实验室","logo":{"@type":"ImageObject","url":{"text":"UinIO.com"}}},"description":"OpenSSL\r 是用于安全传输层（TLS，Transport Layer\r Security）协议和安全套接字层（SSL，Secure\r Sockets Layer）协议的的工具包，提供了 SSL\r 协议实现（SSLv2、SSLv3、TLSv1）、大量算法实现（对称&#x2F;非对称&#x2F;摘要）、大数运算、非对称算法密钥、ASN.1\r 编解码库、证书请求（PKCS10）编解码、数字证书编解码、CRL\r 编解码"}</script><link rel="canonical" href="http://www.uinio.com/Zen/Cryptology/"><link rel="alternate" href="/atom.xml" title="UinIO.com 电子技术实验室" type="application/atom+xml"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://unpkg.com/highlight.js@11.7.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.font.im/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://unpkg.com/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://unpkg.com/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">UinIO.com</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1514341594">Bilibili</a><a class="navbar-item" target="_blank" rel="noopener" href="https://www.zhihu.com/people/uinika">知乎</a><a class="navbar-item" target="_blank" rel="noopener" href="https://github.com/uinika">Github</a><a class="navbar-item" target="_blank" rel="noopener" href="https://gitee.com/uinika">Gitee</a><a class="navbar-item" href="/archives/index.html">开源硬件</a><a class="navbar-item" href="/my/about.html">关于我</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-09T16:00:00.000Z" title="2021/8/10 00:00:00">2021-08-10</time>发表</span><span class="level-item"><time dateTime="2021-08-12T16:00:00.000Z" title="2021/8/13 00:00:00">2021-08-13</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Zen/">Zen</a></span><span class="level-item">1 小时读完 (大约6800个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">编码实践当中涉及的密码学知识</h1><div class="content"><p><a target="_blank" rel="noopener" href="https://www.openssl.org/"><strong>OpenSSL</strong></a>
是用于<strong>安全传输层</strong>（<strong>TLS</strong>，Transport Layer
Security）协议和<strong>安全套接字层</strong>（<strong>SSL</strong>，Secure
Sockets Layer）协议的的工具包，提供了 SSL
协议实现（<code>SSLv2</code>、<code>SSLv3</code>、<code>TLSv1</code>）、大量算法实现（对称/非对称/摘要）、大数运算、非对称算法密钥、<code>ASN.1</code>
编解码库、证书请求（<code>PKCS10</code>）编解码、数字证书编解码、<code>CRL</code>
编解码、<code>OCSP</code> 协议、数字证书验证、<code>PKCS7</code>
标准实现和 <code>PKCS12</code> 个人数字证书格式实现等功能。</p>
<p><img src="/Zen/Cryptology/logo.png"></p>
<p>然而一直以来 OpenSSL 代码质量，总是受到开发人员的各种诟病，因而出现了
<a target="_blank" rel="noopener" href="https://www.wolfssl.com/">WolfSSL</a> 与 PolorSSL 等 OpenSSL
的开源替代产品，其中 PolarSSL 被 ARM 公司收购之后，现更名为 <a target="_blank" rel="noopener" href="https://tls.mbed.org/"><strong>Mbed TLS</strong></a>，主要由 <a target="_blank" rel="noopener" href="https://www.trustedfirmware.org/"><strong>Trusted
Firmware</strong></a> 组织进行维护，遵循相关的 ARM 规范，并为
<strong>Armv8-A</strong>、<strong>Armv9-A</strong>、<strong>Armv8-M</strong>
内核架构提供了安全可信的参考实现。本文主要主要讨论了
<strong>Base64</strong> 与 <strong>Hash</strong> 编码、以及 OpenSSL
所涉及的相关加解密知识。</p>
<span id="more"></span>
<h2 id="base64-编码">Base64 编码</h2>
<p>Base64 是一种基于 <strong>64</strong>
个可打印字符来表示<strong>二进制数据</strong>的方法，因为 <span class="math inline">\(\log_2 64 = 6\)</span>，所以每 <code>6 bits</code>
为一个单元，对应某个可打印字符。例如 <code>3 Bytes</code> 相当于
<code>24 bits</code>，对应于 <code>4</code> 个 Base64 单元，即
<code>3</code> 个字节可由 <code>4</code> 个可打印字符来表示。Base64
编码常被用于<strong>表示</strong>、<strong>传输</strong>、<strong>存储</strong>一些二进制数据。</p>
<p><img src="/Zen/Cryptology/Base64-1.png"></p>
<p>Base64 当中的可打印字符包括字母 <code>A-Z</code> 和
<code>a-z</code>，以及数字 <code>0-9</code> 共有 <strong>62</strong>
个字符，此外还包括 <strong>2</strong>
个可打印的符号，在不同的操作系统当中表现不同：</p>
<p><img src="/Zen/Cryptology/Base64-2.png"></p>
<blockquote>
<p><strong>注意 1</strong>：标准 Base64 编码并不适用于在
<strong>HTTP</strong> 环境下通过 <strong>URL</strong>
传递较长的信息，这是由于 URL 编码器会将标准 Base64 当中的 <code>/</code>
和 <code>+</code> 字符转换为形如 <code>%XX</code> 的形式，由于标准 SQL
语句当中将 <code>%</code> 符号用作通配符，而这些 <code>%</code>
号在存入数据库时还需要再一次进行转换。为了解决这个问题，可以采用一种用于
URL 的改进 Base64 编码，其并不会在末尾填充 <code>=</code> 号，并将标准
Base64 中的 <code>+</code> 与 <code>/</code> 分别修改为 <code>-</code>
和 <code>_</code>，从而免去了在 URL
编解码和数据库存储时所需要进行的额外转换，避免了编码信息长度在此过程中的增加，并且统一了数据库、Web
页面表单的标识符格式。</p>
</blockquote>
<blockquote>
<p><strong>注意
2</strong>：除此之外，还有一种用于<strong>正则表达式</strong>的改进
Base64 编码变种，其将 <code>+</code> 和 <code>/</code> 分别修改为
<code>!</code> 和 <code>-</code>，这是由于
<code>+</code>，<code>*</code>、<code>[</code>、<code>]</code>
在正则表达式当中可能具有特殊含义。</p>
</blockquote>
<h2 id="hash-散列函数">Hash 散列函数</h2>
<p><strong>散列函数</strong>（Hash）又称为<strong>散列算法</strong>或者<strong>哈希函数</strong>，可以将任意长度的输入通过散列算法转换为固定长度的<strong>散列值</strong>输出，Hash
算法没有固定的公式，只要符合散列思想的算法都可以称为 <strong>Hash
算法</strong>。目前常见的散列算法可以参见下面的表格：</p>
<p><img src="/Zen/Cryptology/Hash-2.png"></p>
<p>所有的散列函数算法都具备如下 2 个基本特征：</p>
<ol type="1">
<li>如果两个散列值是不相同的，那么这两个散列值的原始输入也是不相同的，具有这种性质的散列函数称为<strong>单向散列函数</strong>；</li>
<li>散列函数的输入与输出不是一一对应关系，如果 2 个输出散列值相同，那么
2
个输入值可能相同也可能不同，这种情况称为<strong>散列碰撞</strong>；</li>
</ol>
<p><img src="/Zen/Cryptology/Hash-1.png"></p>
<blockquote>
<p><strong>注意</strong>：利用散列算法所计算出来散列值的不可逆性（无法逆向演算回原本的数值），可以将其用于加密存储在数据库当中的密码字符串，从而有效的保护密码。</p>
</blockquote>
<h3 id="md5-消息摘要算法">MD5 消息摘要算法</h3>
<p><strong>消息摘要算法</strong>（MD5，Message-Digest
Algorithm）通过输入不定长度信息，输出四组 32
位数据，最后组合成为一个固定长度的 <code>128 bits/16 Bytes</code>
散列值，通常用于确保数据传输的完整性。该算法是由美国密码学家罗纳德·李维斯特（Ronald
Linn Rivest）设计，于 1992 年公开，但是已于 1996
年在理论上被证实存在破解可能性，并最终于 2004
年被证实无法防止碰撞攻击，因而不再适用于安全性认证。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">输入字符串：</span><br><span class="line">  Hank</span><br><span class="line"></span><br><span class="line">输出 MD5 字符串：</span><br><span class="line">  16位 	410F72AD50C76F9C</span><br><span class="line">  32位 	BA02B1E3410F72AD50C76F9C144D6B34</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：MD5 加密后的位数有 <code>16 Bytes</code> 和
<code>32 Bytes</code> 两种，其中 <code>16 Bytes</code> 实际上是取
<code>32 Bytes</code> 字符串中间的第 <code>9 ~ 24</code> 位部分。</p>
</blockquote>
<h3 id="sha-安全散列算法">SHA 安全散列算法</h3>
<p><strong>安全散列算法</strong>（SHA，Secure Hash
Algorithm）包含了一系列密码<strong>散列函数算法</strong>，可以计算出一个消息所对应的固定长度字符串（称为<strong>消息摘要</strong>），如果输入的消息不同，那么对应的消息摘要也会不同。SHA
家族算法由<strong>美国国家安全局</strong>（NSA）设计，并由<strong>美国国家标准与技术研究院</strong>（NIST）发布：</p>
<p><img src="/Zen/Cryptology/SHA.png"></p>
<ul>
<li><strong>SHA-0</strong>：1993 年发布，当时称做安全散列标准（Secure
Hash Standard），发布之后很快就被 NSA 撤回；</li>
<li><strong>SHA-1</strong>：1995 年发布，在许多安全协议中广为使用（包括
TLS 和 SSH），被视为 <strong>MD5</strong> 的后继者，于 2017
年被荷兰密码学研究小组正式宣布攻破；</li>
<li><strong>SHA-2</strong>：2001 年发布，包括
<code>SHA-224</code>、<code>SHA-256</code>、<code>SHA-384</code>、<code>SHA-512</code>、<code>SHA-512/224</code>、<code>SHA-512/256</code>，虽然至今尚未出现对该版本算法的有效攻击，但是其算法本质上与
SHA-1 基本类似；</li>
<li><strong>SHA-3</strong>：2015 年正式发布，由于出现了对于 MD5
的成功破解，以及 SHA-0 和 SHA-1 已经出现理论上的破解方法，于是 NIST
推出了该版本的加密散列算法；</li>
</ul>
<h3 id="crc-循环冗余校验">CRC 循环冗余校验</h3>
<p><strong>循环冗余校验</strong>（CRC，Cyclic Redundancy
Check）可以根据文件等数据，利用除法及余数的原理，产生简短的固定位数校验码，也属于一种<strong>散列函数算法</strong>，主要用于校验数据传输完成之后可能出现的错误，能够高比例的纠正数据传输过程当中的错误，并在极短的时间内完成数据校验计算，该方法由
W.Wesley Peterson 于 1961 年发表。</p>
<h2 id="对称与非对称加密">对称与非对称加密</h2>
<p><strong>对称加密算法</strong>（Symmetric-key
Algorithm）又称为<strong>私钥加密</strong>、<strong>共享密钥加密</strong>，属于密码学当中的一类加密算法。这类算法在加密和解密时使用<strong>相同的密钥</strong>（或者两个可以简单相互推算的密钥），这组密钥将会多个成员之间的共同秘密，以便维持专属的通信联系。与公开密钥加密相比，要求双方获取相同的密钥是对称密钥加密的主要缺陷之一。常见的对称加密算法有
<code>AES</code>、<code>ChaCha20</code>、<code>3DES</code>、<code>Salsa20</code>、<code>DES</code>、<code>Blowfish</code>、<code>IDEA</code>、<code>RC5</code>、<code>RC6</code>、<code>Camellia</code>
等等。</p>
<p><strong>非对称式加密算法</strong>（Asymmetric
Cryptography）也称为<strong>公钥加密算法</strong>（Public-key
Cryptography），同样属于密码学当中的一种算法，其加解密过程需要<strong>公开密钥</strong>（用于加密）和<strong>私有密钥</strong>（用于解密）2
个密钥，使用<strong>公钥</strong>将<strong>明文</strong>加密之后所得到的<strong>密文</strong>，只能使用对应的<strong>私钥</strong>才能解密并且得到原来的明文，最初用于加密的公钥并不能用作解密。由于加密与解密需要
2 个不同的密钥，所以被称为非对称加密；</p>
<ul>
<li><strong>加密</strong>：将数据转换为不可直接阅读的形式（即<strong>密文</strong>）；</li>
<li><strong>解密</strong>：将密文转换成能够直接阅读的数据（即<strong>明文</strong>）；</li>
</ul>
<blockquote>
<p><strong>注意</strong>：相比较于加密与解密都要使用同一个密钥的<strong>对称式加密</strong>，<strong>非对称式加密</strong>的公钥可以任意向外发布，但是私钥必须自行严格秘密保管，绝不能透过任何途径向外提供。此外，<strong>对称加密</strong>的速度远远快于<strong>非对称加密</strong>。</p>
</blockquote>
<h3 id="des-数据加密标准">DES 数据加密标准</h3>
<p><strong>数据加密标准</strong>（DES，Data Encryption
Standard），是一种在过去主要使用的<strong>对称加密算法</strong>，1977
年被认定为联邦资料处理标准（FIPS），但是现在已经并非一种安全的加密方法。而
DES
算法的继任者<strong>三重数据加密</strong>（<strong>3DES</strong>，Triple
DES），本质上相当于是对每个数据块运用 3 次 DES
加密，它并非一种全新的块密码算法，并且在理论上也存在破解方法。</p>
<blockquote>
<p><strong>注意</strong>：DES 和 3DES
标准目前已经逐渐被<strong>高级加密标准</strong>（AES）所取代。</p>
</blockquote>
<h3 id="aes-高级加密标准">AES 高级加密标准</h3>
<p><strong>高级加密标准</strong>（AES，Advanced Encryption
Standard），属于美国联邦政府采用的一种区块加密标准，该标准用于替换原先的
DES，由美国国家标准与技术研究院（NIST）于 2001 年 11 月 26 日发布，并于
2002 年 5 月 26
日成为有效标准，目前已经成为<strong>对称密钥加密</strong>里最为流行的算法之一。</p>
<p><img src="/Zen/Cryptology/AES.png"></p>
<ul>
<li><strong>明文</strong>：没有经过加密的原始数据；</li>
<li><strong>密文</strong>：已经经过 AES 加密函数处理之后的数据；</li>
<li><strong>密钥</strong>：用于加密<strong>明文</strong>的密码，对称加密算法当中用于加解密的<strong>密钥</strong>相同，密钥由接收者与发送者协商产生（为了防止密钥泄漏，需要避免直接在网络上进行传输，通常经过非对称加密算法加密密钥，然后再透过网络传输给对方）；</li>
<li><strong>AES
加密函数</strong>：将<strong>明文</strong>与<strong>密钥</strong>作为
<strong>AES 加密函数</strong>的输入<strong>参数</strong>，这样 AES
加密函数就会返回密文，即
<code>密文 = AES 加密函数(明文，密钥)</code>；</li>
<li><strong>AES
解密函数</strong>：将<strong>密文</strong>与<strong>密钥</strong>作为
<strong>AES 解密函数</strong>的输入<strong>参数</strong>，这样 AES
解密函数就会返回明文，即
<code>明文 = AES 解密函数(密文，密钥)</code>；</li>
</ul>
<p>结构上 AES
将明文划分为一系列长度相等的数据组，每次只加密一组数据，直至加密完整个明文。在
AES 标准规范中，分组长度只能是 <code>128 bits</code> 位，即每个分组为
<code>16 Byte</code> 字节，而密钥的长度可以使用
<code>128 bits</code>、<code>192 bits</code> 或者 <code>256 bits</code>
位，密钥的长度不同，推荐加密轮数也不同，具体请参见下面表格：</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">AES</th>
<th style="text-align: center;">密钥长度（32 bits)</th>
<th style="text-align: center;">分组长度(32 bits)</th>
<th style="text-align: center;">加密轮数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>AES-128</strong></td>
<td style="text-align: center;"><code>4</code></td>
<td style="text-align: center;"><code>4</code></td>
<td style="text-align: center;"><code>10</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>AES-192</strong></td>
<td style="text-align: center;"><code>6</code></td>
<td style="text-align: center;"><code>4</code></td>
<td style="text-align: center;"><code>12</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>AES-256</strong></td>
<td style="text-align: center;"><code>8</code></td>
<td style="text-align: center;"><code>4</code></td>
<td style="text-align: center;"><code>14</code></td>
</tr>
</tbody>
</table>
<h3 id="rsa-非对称加密算法">RSA 非对称加密算法</h3>
<p><strong>RSA</strong> 是一种<strong>非对称加密</strong>算法，由 Ron
<strong>R</strong>ivest、Adi <strong>S</strong>hamir、Leonard
<strong>A</strong>dleman 三位麻省理工学院的学者于 1977 年共同提出，RSA
就是由 3 位的姓氏首字母组成。对于极大整数做因数分解的难度决定了 RSA
算法的可靠性（假如找到一种快速因数分解的算法，那么 RSA
的可靠性就会极度下降，但找到这样算法的可能性微乎其微），RSA
诞生近半个世纪后的今天，仅有较短的 RSA
密钥才有可能会被暴力破解。除此之外，世界上还没有任何可以攻击 RSA
算法可靠性的方式，只要其密钥的长度足够长，采用 RSA
加密后的信息基本不可能被破解。</p>
<p>下面是一个基于 RSA
算法的典型<strong>双向非对称加密</strong>握手步骤：</p>
<ol type="1">
<li><strong>A</strong> 和 <strong>B</strong> 分别基于 RSA
生成各自的公钥与私钥，然后 <strong>A</strong>、<strong>B</strong>
分别将自己的<strong>公钥</strong>交给 CA 
服务器，从而获得<strong>公钥证书</strong>；</li>
<li>当 <strong>A</strong> 与 <strong>B</strong>
进行通信时，首先双方会交换<strong>公钥证书</strong>进行身份认证，然后由
A 生成<strong>随机字符串</strong>作为<strong>对称密钥</strong>，并使用
<strong>B</strong> 的<strong>公钥</strong>进行加密，然后将其发送给
<strong>B</strong>；</li>
<li><strong>B</strong>
接收之后使用自己的<strong>私钥</strong>提取该<strong>对称密钥</strong>，从而完成双向非对称加密的握手步骤；</li>
</ol>
<h2 id="使用-openssl-进行签名与验证">使用 OpenSSL 进行签名与验证</h2>
<h3 id="签名文件">签名文件</h3>
<p>使用 OpenSSL
签名一个文件需要使用到<strong>私钥</strong>，可以通过下面的命令创建
OpenSSL 公私钥对：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成保存私钥的文件 private.pem</span></span><br><span class="line">openssl genrsa -aes128 -passout pass:&lt;phrase&gt; -out private.pem 4096</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据私钥生成保存公钥的文件 public.pem</span></span><br><span class="line">openssl rsa -in private.pem -passin pass:&lt;phrase&gt; -pubout -out public.pem</span><br></pre></td></tr></table></figure>
<p>上述命令中的 <code>&lt;phrase&gt;</code> 密码短语用于加密存储在
<code>private.pem</code>
文件里的<strong>私钥</strong>，出于安全的原因，建议使用
<code>4096 bits</code> 位的私钥，具体原因可以参见 <a target="_blank" rel="noopener" href="https://danielpocock.com/rsa-key-sizes-2048-or-4096-bits/">《RSA
Key Sizes: 2048 or 4096
bits?》</a>一文。当命令执行完毕之后，<strong>私钥</strong>将会被保存在当前目录下的
<code>private.pem</code> 文件，而<strong>公钥</strong>则会被保存在
<code>public.pem</code> 文件。</p>
<p><strong>【示例】</strong>：将 <code>&lt;phrase&gt;</code>
密码短语设置为 <code>Hank</code>，然后使用 OpenSSL
命令生成私钥文件：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  <span class="built_in">sudo</span> openssl genrsa -aes128 -passout pass:Hank -out private.pem 4096</span><br><span class="line">Generating RSA private key, 4096 bit long modulus (2 primes)</span><br><span class="line">.................++++</span><br><span class="line">..................................................................................................................................++++</span><br><span class="line">e is 65537 (0x010001)</span><br><span class="line"></span><br><span class="line">➜  <span class="built_in">ls</span></span><br><span class="line">private.pem</span><br></pre></td></tr></table></figure>
<p><strong>【示例】</strong>：然后，再通过上面得到的
<code>private.pem</code> 文件，来生成对应的公钥文件
<code>public.pem</code>：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  <span class="built_in">sudo</span> openssl rsa -<span class="keyword">in</span> private.pem -passin pass:Hank -pubout -out public.pem</span><br><span class="line">writing RSA key</span><br><span class="line"></span><br><span class="line">➜  <span class="built_in">ls</span></span><br><span class="line">private.pem  public.pem</span><br></pre></td></tr></table></figure>
<h3 id="base64-编码-1">Base64 编码</h3>
<p>拥有了<strong>公钥</strong>与<strong>私钥</strong>之后，接下来就可以使用
OpenSSL 签名一个文件，这个过程当中将会要求提供密码短语
<code>&lt;phrase&gt;</code>。由于过去 OpenSSL
<strong>签名</strong>的默认输出格式为二进制，如果希望在互联网上进行传输，则需要采用
<code>Base64</code> 对签名文件进行编码转换：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">基于私钥生成签名文件</span></span><br><span class="line">openssl dgst -sha256 -sign &lt;private-key&gt; -out signature.sha256 &lt;target-file&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将签名文件转换为 Base64 格式</span></span><br><span class="line">openssl base64 -in signature.sha256 -out &lt;base64-signature&gt;</span><br></pre></td></tr></table></figure>
<p>上述语句中的 <code>&lt;private-key&gt;</code>
是包含私钥的文件，<code>&lt;target-file&gt;</code> 为待签名的文件，而
<code>&lt;base64-signature&gt;</code> 为 Base64
格式的数字签名的文件名，操作完成之后签名文件将会保存为 <code>/opt</code>
目录下的 <code>signature.sha256</code> 文件。</p>
<p><strong>【示例】</strong>：使用前一步生成的私钥文件
<code>private.pem</code> 对当前目录下的 <code>uinika.c</code>
文件进行签名，得到一个二进制签名文件 <code>signature.sha256</code>：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜   <span class="built_in">sudo</span> openssl dgst -sha256 -sign private.pem -out signature.sha256 uinika.c</span><br><span class="line">Enter pass phrase <span class="keyword">for</span> private.pem: Hank</span><br><span class="line">➜   <span class="built_in">ls</span></span><br><span class="line">private.pem  public.pem  signature.sha256  uinika.c</span><br></pre></td></tr></table></figure>
<p><strong>【示例】</strong>：将 <code>/opt</code> 目录下的二进制文件
<code>signature.sha256</code> 转换为 Base64 编码的
<code>signature.base64</code> 文件：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜   <span class="built_in">sudo</span> openssl <span class="built_in">base64</span> -<span class="keyword">in</span> signature.sha256 -out signature.base64</span><br><span class="line">➜   <span class="built_in">ls</span></span><br><span class="line">private.pem  public.pem  signature.base64  signature.sha256  uinika.c</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：目前新版本的 OpenSSL
签名文件，已经可以正常在互联网上传输，不需要再进行额外的 Base64
编码。</p>
</blockquote>
<h3 id="验证签名">验证签名</h3>
<p>将签名从 Base64
编码重新转换回二进制文件，并使用前面得到的<strong>公钥</strong>来验证该签名文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将签名文件从 Base64 编码还原为二进制格式</span></span><br><span class="line">openssl base64 -d -in &lt;base64-signature&gt; -out signature.sha256</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用公钥验证签名文件</span></span><br><span class="line">openssl dgst -sha256 -verify &lt;public-key&gt; -signature signature.sha256 &lt;target-file&gt;</span><br></pre></td></tr></table></figure>
<p>上述命令当中的 <code>&lt;base64-signature&gt;</code> 是包含 Base64
签名的文件，而 <code>&lt;public-key&gt;</code>
是包含公钥的文件，<code>&lt;target-file&gt;</code>
则是待验证的二进制签名文件。验证成功之后，OpenSSL 将会提示
<code>Verified OK</code>，否则就会提示
<code>verification Failure</code>。</p>
<p><strong>【示例】</strong>： 把 Base64 编码的签名文件
<code>signature.base64</code> 还原为二进制格式的签名文件
<code>signature.sha256</code>：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜   <span class="built_in">sudo</span> openssl <span class="built_in">base64</span> -d -<span class="keyword">in</span> signature.base64 -out signature.sha256</span><br><span class="line">➜   <span class="built_in">ls</span></span><br><span class="line">private.pem  public.pem  signature.base64  signature.sha256  uinika.c</span><br></pre></td></tr></table></figure>
<p><strong>【示例】</strong>：通过目标文件 <code>uinika.c</code>
和公钥文件 <code>public.pem</code> 校验还原得到的
<code>signature.sha256</code> 是否有效：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜   <span class="built_in">sudo</span> openssl dgst -sha256 -verify public.pem -signature signature.sha256 uinika.c</span><br><span class="line">Verified OK</span><br></pre></td></tr></table></figure>
<h2 id="安全套接层-ssl-传输层安全-tls">安全套接层 SSL / 传输层安全
TLS</h2>
<p><strong>传输层安全性协议</strong>（TLS，Transport Layer
Security）以及其前身<strong>安全套接层</strong>（<strong>SSL</strong>，Secure
Sockets
Layer）都属于一种安全协议，目的是为互联网通信提供安全以及数据完整性保障。网景公司（Netscape）于
1994 年推出第 1 版网页浏览器时发布了 HTTPS 协议，并以 SSL 进行加密，后来
<strong>IETF</strong> 将 SSL 进行标准化，于 1999 年公布了
<code>TLS 1.0</code>，随后又于 2006 年公布了 <code>TLS 1.1</code>，2008
年公布了 <code>TLS 1.2</code>，以及在 2018 年公布的
<code>TLS 1.3</code>，目前该协议已经成为<strong>互联网</strong>加密通信的工业标准。</p>
<p>TLS 协议采用<strong>主从式架构</strong>模型，用于在网络上的 2
个应用程序之间创建安全的连接，防止在交换资料时受到窃听以及篡改。TLS
协议与高层的 <code>HTTP</code>、<code>FTP</code>、<code>Telnet</code>
等应用层协议并不会产生耦合，这些应用层协议透明的运行在 TLS 之上，由 TLS
进行创建加密通道需要的协商与认证，应用层协议传送的数据通过 TLS
协议时都会被加密，从而保证通信的私密性。</p>
<p>TLS
协议必须在<strong>客户端</strong>与<strong>服务器</strong>分别配置之后才能使用，一旦客户端和服务器都同意使用
TLS
协议，那么它们会通过一个<strong>握手过程</strong>，协商出一个带有状态的连接用于传输数据，如下就是握手建立的具体步骤：</p>
<ol type="1">
<li><strong>客户端</strong>连接到支持 TLS
协议的<strong>服务器</strong>，要求创建安全连接并且列出了受支持的密码包（包括加密和散列算法等）；</li>
<li><strong>服务器</strong>从该列表中确定好密码包，并且通知<strong>客户端</strong>；</li>
<li><strong>服务器</strong>返回其数字证书，该证书通常包含有<code>服务器的名称</code>、<code>受信任的证书颁发机构（CA）</code>、<code>服务器的公钥</code>；</li>
<li><strong>客户端</strong>确认其颁发证书的有效性；</li>
<li>为生成用于安全连接的会话密钥，<strong>客户端</strong>使用<strong>服务器</strong>的公钥加密随机生成的密钥，并将其发送至<strong>服务器</strong>，此时只有<strong>服务器</strong>才能使用自己的私钥进行解密；</li>
<li>利用随机数，双方生成用于加密和解密的对称密钥，从而完成 TLS
协议的握手过程；</li>
</ol>
<blockquote>
<p><strong>注意</strong>：握手完毕之后的连接是安全的，直到该连接被关闭为止；如果上述任何一个步骤失败，TLS
的握手过程就会失败，并且断开所有连接；</p>
</blockquote>
<h2 id="公钥数字签名">公钥数字签名</h2>
<p><strong>公钥数字签名</strong>也称为<strong>数字签名</strong>（Digital
Signature），其实质就是逆向使用非对称加密体系，即签名者将信息用私钥加密（非对称加密体系下，私钥通常用于解密），然后将公钥发布出去，验证者使用公钥将加密信息解密并且比对消息（非对称加密体系下，公钥通常用于加密）。</p>
<p>概而言之，非对称加密体系下，通常使用<code>公钥加密，私钥解密</code>。而在数字签名当中，则是使用<code>私钥加密（生成签名），公钥解密（验证签名）</code>。</p>
<p>我们可以直接对数据进行<strong>签名</strong>（即使用私钥加密，其目的是为了签名，而非保密），验证者用公钥正确解密消息，如果和原始数据保持一致，则签名验证成功。通常情况下，我们只会对数据的
Hash 值进行签名（但是计算数据 Hash 值并非数字签名的必要步骤），因为 Hash
值的长度远远小于原始数据的长度，从而使得签名（非对称加密）的效率大幅度提高。</p>
<blockquote>
<p><strong>注意</strong>：工程实践当中，通常会组合使用<strong>加密</strong>与<strong>签名</strong>技术，例如前面提到的
TLS 协议就同时组合了<strong>加密</strong>与<strong>签名</strong>。</p>
</blockquote>
<h2 id="ca-数字证书认证">CA 数字证书认证</h2>
<p><strong>数字证书认证</strong>（CA，Certificate
Authority）是用于实现多方<strong>安全通信</strong>所提供<strong>电子认证</strong>，其本质上是由证书签证机构
CA 签发的对于用户<strong>公钥</strong>的认证。这里的 CA
即指代负责发放与管理数字证书的权威机构，也指代其所承担的位于非对称加密体系当中的<strong>公钥</strong>合法性校验任务，主要具有如下的作用与特点：</p>
<ul>
<li>如果用户需要获取 CA 证书，就应当向 CA 机构提出申请，CA
机构判别出申请者的身份之后，就会为其分配一个公钥，并将该公钥与其身份信息绑定为一个整体，并为该整体进行签名，这个签名之后的整体就称为<strong>证书</strong>，最后会将该证书发还给申请者；</li>
<li><strong>CA</strong>
既是<strong>证书</strong>的签发机构，也是<strong>公钥基础设施</strong>的核心。它为每个使用公开密钥的用户发放一个数字证书，用于核验证书当中罗列的用户，是否合法的拥有证书当中列出的公开密钥。与此同时，CA
机构的数字签名使得攻击者不能伪造和篡改证书；</li>
<li>如果某个用户想鉴别另一个证书的真伪，就需要使用 CA
的<strong>公钥</strong>对该证书上的<strong>签名</strong>进行验证，验证通过之后，该证书才会被认为有效；</li>
</ul>
<p>数字证书的内容包括有
<code>CA 机构的相关信息</code>、<code>公钥用户信息</code>、<code>公钥</code>、<code>CA 机构的签名与有效期</code>
等，目前数字证书的格式与验证方法普遍遵循 <strong>X.509</strong>
公钥证书格式标准。</p>
<h2 id="x.509-公钥证书格式标准">X.509 公钥证书格式标准</h2>
<p><strong>X.509</strong>
是密码学当中<strong>公钥证书</strong>的格式标准，应用于 TLS/SSL
在内的众多网络协议当中。X.509
证书当中包含有<strong>公钥</strong>、<strong>身份信息</strong>（比如网络主机名，组织或个体名称等）、<strong>签名信息</strong>（即可以是证书签发机构的
CA 签名，也可以是自签名）。</p>
<blockquote>
<p><strong>注意</strong>：在 X.509
当中，组织机构通过发起<strong>证书签名请求</strong>（CSR，Certificate
Signing Request）来获得一份签名证书。</p>
</blockquote>
<p><strong>X.509</strong> 拥有如下几种常用的扩展名：</p>
<ul>
<li><code>.pem</code>：隐私增强型电子邮件格式，通常为 Base64 格式；</li>
<li><code>.cer</code>、<code>.crt</code>、<code>.der</code>：通常为 DER
二进制格式；</li>
<li><code>.p7b</code>、<code>.p7c</code>：<strong>PKCS#7</strong>
格式，不包含数据，只包含证书或者 CRL；</li>
<li><code>.p12</code>：<strong>PKCS#12</strong>
格式，包含证书的同时可能还包含有私钥；</li>
<li><code>.pfx</code>：<strong>PFX</strong>，在 <code>PKCS#12</code>
出现之前使用的格式；</li>
</ul>
<blockquote>
<p><strong>注意</strong>：<strong>PKCS#7</strong>
是签名或者加密数据的格式标准，由于证书是可以进行校验的签名数据，所以采用<strong>签名数据</strong>（SignedData）结构进行表述；而
<strong>PKCS#12</strong> 则是由 PFX
格式发展而来，用于交换公有或者私有对象的标准格式。</p>
</blockquote>
<h2 id="国密算法">国密算法</h2>
<p><strong>国密算法</strong>主要是经由<a target="_blank" rel="noopener" href="https://www.oscca.gov.cn/">《密码管理局》</a>和<a target="_blank" rel="noopener" href="http://www.gmbz.org.cn/main/bzlb.html">《密码行业标准化技术委员会》</a>认定的国产密码算法，当前使用较为广泛的主要是以下
5 种：</p>
<ul>
<li><strong>祖冲之序列密码</strong>：中国自主研发的流密码算法,是
运用于移动 4G
网络当中的国际标准密码算法，该算法包括<strong>祖冲之算法</strong>（ZUC）、<strong>加密算法</strong>（128-EEA3）、<strong>完整性算法</strong>（128-EIA3）三个部分；</li>
<li><strong>SM2 椭圆曲线公钥密码算法</strong>：即 ECC
椭圆曲线密码机制，但在签名和密钥交换方面不同于
<code>ECDSA</code>、<code>ECDH</code>
等国际标准，该标准包括<code>总则</code>、<code>数字签名算法</code>、<code>密钥交换协议</code>、<code>公钥加密算法</code>四个部分；</li>
<li><strong>SM3
密码杂凑算法</strong>：给出了杂凑函数算法（哈希、散列）的计算方法与步骤，适用于商业密码应用当中的<code>数字签名</code>与<code>验证</code>；该算法对输入长度小于
<span class="math inline">\(2^{64}\)</span>
次方的数据，经过填充与迭代压缩，生成长度为 <code>256 bits</code>
位的杂凑值，该算法由<code>填充</code>、<code>迭代过程</code>、<code>消息扩展</code>、<code>压缩函数</code>四部分构成。</li>
<li><strong>SM4
分组密码算法</strong>：常用于无线局域网通信，该算法的分组长度和密钥长度均为
<code>128 bits</code> 位，加密算法与密钥扩展算法都采用 32
轮非线性迭代结构，其中加解密算法的结构相同，只是<strong>轮密钥</strong>的使用顺序相反，<code>解密轮密钥</code>是<code>加密轮密钥</code>的逆序；</li>
<li><strong>SM9
标识密码算法</strong>：该算法不需要申请数字证书，适用于互联网安全、物联网安全等，典型的应用是采用手机号码、邮件地址作为<strong>公钥</strong>，实现数据加密、身份认证、通话加密、通道加密等安全应用，并具有使用方便，易于部署的特点；</li>
</ul>
<blockquote>
<p><strong>注意</strong>：<strong>密码行业标准化技术委员会</strong>（CSTC，Cryptography
Standardization Technical
Committee）是一家国内从事密码标准化工作的<strong>非法人技术组织</strong>，归属密码管理局领导和管理，主要从事密码技术、产品、系统和管理等方面的标准化工作。</p>
</blockquote>
</div><div class="article-licensing box"><div class="licensing-title"><p>编码实践当中涉及的密码学知识</p><p><a href="http://www.uinio.com/Zen/Cryptology/">http://www.uinio.com/Zen/Cryptology/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hank</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-08-10</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-08-13</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Encrypt/">Encrypt</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Embedded/Mifare/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">智能 IC 卡技术杂谈</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Electronics/Digital/"><span class="level-item">现代数字逻辑电子技术概论</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#base64-编码"><span class="level-left"><span class="level-item">1</span><span class="level-item">Base64 编码</span></span></a></li><li><a class="level is-mobile" href="#hash-散列函数"><span class="level-left"><span class="level-item">2</span><span class="level-item">Hash 散列函数</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#md5-消息摘要算法"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">MD5 消息摘要算法</span></span></a></li><li><a class="level is-mobile" href="#sha-安全散列算法"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">SHA 安全散列算法</span></span></a></li><li><a class="level is-mobile" href="#crc-循环冗余校验"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">CRC 循环冗余校验</span></span></a></li></ul></li><li><a class="level is-mobile" href="#对称与非对称加密"><span class="level-left"><span class="level-item">3</span><span class="level-item">对称与非对称加密</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#des-数据加密标准"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">DES 数据加密标准</span></span></a></li><li><a class="level is-mobile" href="#aes-高级加密标准"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">AES 高级加密标准</span></span></a></li><li><a class="level is-mobile" href="#rsa-非对称加密算法"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">RSA 非对称加密算法</span></span></a></li></ul></li><li><a class="level is-mobile" href="#使用-openssl-进行签名与验证"><span class="level-left"><span class="level-item">4</span><span class="level-item">使用 OpenSSL 进行签名与验证</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#签名文件"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">签名文件</span></span></a></li><li><a class="level is-mobile" href="#base64-编码-1"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">Base64 编码</span></span></a></li><li><a class="level is-mobile" href="#验证签名"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">验证签名</span></span></a></li></ul></li><li><a class="level is-mobile" href="#安全套接层-ssl-传输层安全-tls"><span class="level-left"><span class="level-item">5</span><span class="level-item">安全套接层 SSL / 传输层安全
TLS</span></span></a></li><li><a class="level is-mobile" href="#公钥数字签名"><span class="level-left"><span class="level-item">6</span><span class="level-item">公钥数字签名</span></span></a></li><li><a class="level is-mobile" href="#ca-数字证书认证"><span class="level-left"><span class="level-item">7</span><span class="level-item">CA 数字证书认证</span></span></a></li><li><a class="level is-mobile" href="#x.509-公钥证书格式标准"><span class="level-left"><span class="level-item">8</span><span class="level-item">X.509 公钥证书格式标准</span></span></a></li><li><a class="level is-mobile" href="#国密算法"><span class="level-left"><span class="level-item">9</span><span class="level-item">国密算法</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Design/"><span class="level-start"><span class="level-item">Design</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Electronics/"><span class="level-start"><span class="level-item">Electronics</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Embedded/"><span class="level-start"><span class="level-item">Embedded</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/English/"><span class="level-start"><span class="level-item">English</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Project/"><span class="level-start"><span class="level-item">Project</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Thinking/"><span class="level-start"><span class="level-item">Thinking</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Zen/"><span class="level-start"><span class="level-item">Zen</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%B5%E5%AD%90%E7%A1%AC%E4%BB%B6/"><span class="level-start"><span class="level-item">电子硬件</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Battery/"><img src="/Electronics/Battery/logo.png" alt="关于锂离子电池选型里的一些重要细节"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-08-28T16:00:00.000Z">2024-08-29</time></p><p class="title"><a href="/Electronics/Battery/">关于锂离子电池选型里的一些重要细节</a></p><p class="categories"><a href="/categories/%E7%94%B5%E5%AD%90%E7%A1%AC%E4%BB%B6/">电子硬件</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/LTspice/"><img src="/Electronics/LTspice/logo.png" alt="如何使用新版本的 LTspice 进行模拟电路仿真"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-21T16:00:00.000Z">2024-05-22</time></p><p class="title"><a href="/Electronics/LTspice/">如何使用新版本的 LTspice 进行模拟电路仿真</a></p><p class="categories"><a href="/categories/Electronics/">Electronics</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/SI9000/"><img src="/Electronics/SI9000/logo.png" alt="基于 Polar Si9000e 计算传输线特征阻抗的全攻略"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-04-04T16:00:00.000Z">2024-04-05</time></p><p class="title"><a href="/Electronics/SI9000/">基于 Polar Si9000e 计算传输线特征阻抗的全攻略</a></p><p class="categories"><a href="/categories/Electronics/">Electronics</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Component/"><img src="/Electronics/Component/logo.png" alt="硬件电路设计当中 の 常用分立元器件选型"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-03-30T16:00:00.000Z">2024-03-31</time></p><p class="title"><a href="/Electronics/Component/">硬件电路设计当中 の 常用分立元器件选型</a></p><p class="categories"><a href="/categories/Electronics/">Electronics</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Project/UINIO-MCU-GD32/"><img src="/Project/UINIO-MCU-GD32/logo.png" alt="兆易创新 UINIO-MCU-GD32F350 固件库开发指南"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-03-17T16:00:00.000Z">2024-03-18</time></p><p class="title"><a href="/Project/UINIO-MCU-GD32/">兆易创新 UINIO-MCU-GD32F350 固件库开发指南</a></p><p class="categories"><a href="/categories/Project/">Project</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Analog-Circuit/"><span class="tag">Analog Circuit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-C/"><span class="tag">C/C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CAD/"><span class="tag">CAD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Calculus/"><span class="tag">Calculus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Circuit-Analysis/"><span class="tag">Circuit Analysis</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Circuit-Theory/"><span class="tag">Circuit Theory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Command/"><span class="tag">Command</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Component/"><span class="tag">Component</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Config/"><span class="tag">Config</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Convention/"><span class="tag">Convention</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Digital-Circuit/"><span class="tag">Digital Circuit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDA/"><span class="tag">EDA</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Economy/"><span class="tag">Economy</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Elementary/"><span class="tag">Elementary</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Encrypt/"><span class="tag">Encrypt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GCC-GDB/"><span class="tag">GCC/GDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grammar/"><span class="tag">Grammar</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTML/"><span class="tag">HTML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Industry/"><span class="tag">Industry</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Instrument/"><span class="tag">Instrument</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LaTeX/"><span class="tag">LaTeX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Life/"><span class="tag">Life</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MCU/"><span class="tag">MCU</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Make/"><span class="tag">Make</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Markdown/"><span class="tag">Markdown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mobile/"><span class="tag">Mobile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/New-Concept-English/"><span class="tag">New Concept English</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PCB/"><span class="tag">PCB</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Protocol/"><span class="tag">Protocol</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python3/"><span class="tag">Python3</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Qt/"><span class="tag">Qt</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RFID/"><span class="tag">RFID</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Server/"><span class="tag">Server</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shell/"><span class="tag">Shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Simulation/"><span class="tag">Simulation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Solidity/"><span class="tag">Solidity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tools/"><span class="tag">Tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Zen/"><span class="tag">Zen</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%B1%A0/"><span class="tag">电池</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%BA%90/"><span class="tag">电源</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img src="/images/ICP.png"> 蜀 ICP 备 2021027760 号</a><p class="is-size-7">Copyright © 2024 <span>UinIO.com</span> by Hank</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://unpkg.com/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://unpkg.com/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://unpkg.com/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://unpkg.com/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://unpkg.com/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script src="/js/math.js"></script><script id="MathJax-script" async src="/js/es5/tex-mml-chtml.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>