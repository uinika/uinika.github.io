<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Webpack 4 核心配置剖析 - UinIO.com 电子技术实验室</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UinIO 电子技术实验室"><meta name="msapplication-TileImage" content="/images/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UinIO 电子技术实验室"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Webpack 是现代 Web 应用程序的静态模块打包工具，它会递归的构建应用程序各个模块的依赖关系图，然后将所有模块打包成一个或多个bundle。目前 Webpack 已经更新至 4.29.6 版本，增加了诸多打包和执行性能相关的支持，是目前应用最广泛、社区最活跃的 Web 前端代码打包方案。而更新版本的 Webpack 5 已经进入 Beta 发布阶段，未来将会带来更多构建性能的提"><meta property="og:type" content="blog"><meta property="og:title" content="Webpack 4 核心配置剖析"><meta property="og:url" content="http://www.uinio.com/Web/Webpack/"><meta property="og:site_name" content="UinIO.com 电子技术实验室"><meta property="og:description" content="Webpack 是现代 Web 应用程序的静态模块打包工具，它会递归的构建应用程序各个模块的依赖关系图，然后将所有模块打包成一个或多个bundle。目前 Webpack 已经更新至 4.29.6 版本，增加了诸多打包和执行性能相关的支持，是目前应用最广泛、社区最活跃的 Web 前端代码打包方案。而更新版本的 Webpack 5 已经进入 Beta 发布阶段，未来将会带来更多构建性能的提"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.uinio.com/images/favicon.png"><meta property="article:published_time" content="2016-04-12T16:00:00.000Z"><meta property="article:modified_time" content="2016-05-16T16:00:00.000Z"><meta property="article:author" content="Hank"><meta property="article:tag" content="JavaScript"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://www.uinio.com/images/favicon.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.uinio.com/Web/Webpack/"},"headline":"Webpack 4 核心配置剖析","image":["http://www.uinio.com/Web/Webpack/logo.png"],"datePublished":"2016-04-12T16:00:00.000Z","dateModified":"2016-05-16T16:00:00.000Z","author":{"@type":"Person","name":"Hank"},"publisher":{"@type":"Organization","name":"UinIO.com 电子技术实验室","logo":{"@type":"ImageObject","url":{"text":"UinIO Lab"}}},"description":"Webpack 是现代\r Web\r 应用程序的静态模块打包工具，它会递归的构建应用程序各个模块的依赖关系图，然后将所有模块打包成一个或多个bundle。目前\r Webpack 已经更新至 4.29.6\r 版本，增加了诸多打包和执行性能相关的支持，是目前应用最广泛、社区最活跃的\r Web 前端代码打包方案。而更新版本的 Webpack 5 已经进入 Beta\r 发布阶段，未来将会带来更多构建性能的提"}</script><link rel="canonical" href="http://www.uinio.com/Web/Webpack/"><link rel="alternate" href="/atom.xml" title="UinIO.com 电子技术实验室" type="application/atom+xml"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://unpkg.com/highlight.js@11.7.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.font.im/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://unpkg.com/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://unpkg.com/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">UinIO Lab</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" target="_blank" rel="noopener" href="https://space.bilibili.com/1514341594">Bilibili</a><a class="navbar-item" target="_blank" rel="noopener" href="https://www.zhihu.com/people/uinika">知乎</a><a class="navbar-item" target="_blank" rel="noopener" href="https://github.com/uinika">Github</a><a class="navbar-item" target="_blank" rel="noopener" href="https://gitee.com/uinika">Gitee</a><a class="navbar-item" href="/my/works.html">开源硬件</a><a class="navbar-item" href="/my/about.html">关于我</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2016-04-12T16:00:00.000Z" title="2016/4/13 00:00:00">2016-04-13</time>发表</span><span class="level-item"><time dateTime="2016-05-16T16:00:00.000Z" title="2016/5/17 00:00:00">2016-05-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Web-%E5%BC%80%E5%8F%91/">Web 开发</a></span><span class="level-item">23 分钟读完 (大约3470个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Webpack 4 核心配置剖析</h1><div class="content"><p><strong><a target="_blank" rel="noopener" href="https://webpack.js.org">Webpack</a></strong> 是现代
Web
应用程序的静态模块打包工具，它会递归的构建应用程序各个模块的依赖关系图，然后将所有模块打包成一个或多个<code>bundle</code>。目前
Webpack 已经更新至 <strong>4.29.6</strong>
版本，增加了诸多打包和执行性能相关的支持，是目前应用最广泛、社区最活跃的
Web 前端代码打包方案。而更新版本的 Webpack 5 已经进入 Beta
发布阶段，未来将会带来更多构建性能的提升，本文依然以更为稳定的 Webpack 4
为讲解对象。</p>
<p><img src="/Web/Webpack/logo.png"></p>
<p>Webpack
提出了<strong>入口</strong><code>entry</code>、<strong>输出</strong><code>output</code>、<strong>加载器</strong><code>loader</code>、<strong>插件</strong><code>plugin</code>这四个核心概念，本文将会在简单介绍
Webpack
相关基础概念之后，对其原生实现的<code>import</code>模块导入机制进行分析，以清晰的展现
Wepback
在底层所进行的工作；最后逐步备注笔者在开发、生产环境下使用到的各类插件和加载器，并分享在<a target="_blank" rel="noopener" href="https://github.com/uinika/aves">aves</a>和<a target="_blank" rel="noopener" href="https://github.com/uinika/rhino">rhino</a>两个开源脚手架项目当中（<em>分别基于
Vue2 和 React16</em>）所使用到的最佳配置实践。</p>
<span id="more"></span>
<h2 id="入口-entry">入口 entry</h2>
<p><code>entry</code>属性用来指定 webpack
应该使用哪个模块作为构建工作的起点，进入起点后 webpack
将会寻找入口起点直接或间接的依赖，并最后输出到称为<code>bundle</code>的文件。Webpack
中的<code>entry</code>属性值可以是一个或多个字符串、一个对象或数组。</p>
<p>下面的示例代码当中只定义了一个路径字符串：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./app.js&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>而下面的示例代码则通过传入对象指明了多个入口点，实质上 Webpack
会使用<code>CommonsChunkPlugin</code>从应用 bundle
中提取<code>vendor</code>引用到<code>vendor bundle</code>，并将引用<code>vendor</code>的部分替换为<code>__webpack_require__()</code>调用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&quot;./app.js&quot;</span>,</span><br><span class="line">    <span class="attr">vendors</span>: <span class="string">&quot;./jquery.js&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Webpack
内置的<code>CommonsChunkPlugin</code>可以为每个页面的共享代码创建
bundle，使得即使在多页面应用下，也能够复用入口起点之间的大量代码和模块。</p>
</blockquote>
<h2 id="输出-output">输出 output</h2>
<p>Webpack 的 output 属性指定其所创建的 bundles
输出到何处以及如何命名，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./app.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;app.bundle.js&#x27;</span>  <span class="comment">// filename属性用于指定bundle的名称</span></span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>),  <span class="comment">// path属性指定输出bundle的位置</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Webpack 中的<code>chunk</code>（[tʃʌŋk]
n.大块，厚块，数据块）是指<strong>一个独立的文件</strong>，如果创建了多个<code>chunk</code>，则应该使用<strong>占位符</strong>去确保每个文件具有唯一的名称。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将带有hash字符串后缀的app.js和search.js保存至build目录下</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">entry</span>: &#123;</span><br><span class="line">      <span class="attr">app</span>: <span class="string">&#x27;./app.js&#x27;</span>,</span><br><span class="line">      <span class="attr">mobile</span>: <span class="string">&#x27;./mobile.js&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;[name][chunkhash].js&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>output</code>属性的<code>filename</code>拥有如下 5
个占位符：</p>
<table>
<thead>
<tr>
<th style="text-align: left;">占位符</th>
<th style="text-align: left;">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>[id]</code></td>
<td style="text-align: left;">模块标识符。</td>
</tr>
<tr>
<td style="text-align: left;"><code>[name]</code></td>
<td style="text-align: left;">模块名称。</td>
</tr>
<tr>
<td style="text-align: left;"><code>[hash]</code></td>
<td style="text-align: left;">模块标识符的 hash 值。</td>
</tr>
<tr>
<td style="text-align: left;"><code>[chunkhash]</code></td>
<td style="text-align: left;"><code>chunk</code>内容的 hash 值。</td>
</tr>
<tr>
<td style="text-align: left;"><code>[query]</code></td>
<td style="text-align: left;">模块的<code>query</code>，例如文件名<code>?</code>后的字符串。</td>
</tr>
</tbody>
</table>
<h2 id="加载器-loader">加载器 loader</h2>
<p>Webpack 的 loader 加载器机制用于处理非 JavaScript 文件，并将其转换为
Webpack 能够处理的有效模块。即将 JavaScript
之外的其它类型文件，转换为<code>bundle</code>可以直接引用的模块；例如：将文件从
TypeScript 转换为 JavaScript，或者把内联图片转换为 data URL，甚至允许在
JavaScript 模块内引入 CSS 文件。</p>
<p>Webpack
配置文件中的<code>module</code>属性主要用于加载各种模块，可以通过其内嵌的<code>rules</code>属性指定加载某种类型文件时所需要使用到的<code>loader</code>加载器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&#x27;./app.js&#x27;</span>,</span><br><span class="line">    <span class="attr">mobile</span>: <span class="string">&#x27;./mobile.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name][chunkhash].js&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 首先需要npm install ts-loader css-loader</span></span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.ts$/</span>,</span><br><span class="line">        <span class="attr">use</span>: <span class="string">&#x27;ts-loader&#x27;</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>rules</code>下的<code>use</code>属性指定了需要使用的目标加载器，而<code>test</code>属性则用于标识需要加载器进行处理的文件。根据需要，开发人员还可以对同一类文件应用多个<code>loader</code>进行处理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">  <span class="attr">use</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">modules</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>loader</code>还可以在<code>import</code>语句中内联进行使用，用于针对特定<code>import</code>语句使用指定的加载器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Styles</span> <span class="keyword">from</span> <span class="string">&quot;style-loader!css-loader?modules!./styles.css&quot;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>加载器 loader
的解析是通过<code>resolver</code>库进行的，<code>resolver</code>用于帮助
Webpack
找到<code>bundle</code>中需要引入的模块代码，这些代码包含在每条<code>require</code>/<code>import</code>语句当中。Webpack
打包模块时会使用到自家的开源项目<a target="_blank" rel="noopener" href="https://github.com/webpack/enhanced-resolve">enhanced-resolve</a>来解析引入的文件路径。</p>
</blockquote>
<h2 id="插件-plugin">插件 plugin</h2>
<p>如同上面所描述的那样，loader 用于转换某些类型的模块，而插件 plugin
得益于其丰富的接口，可以用来处理加载器 loader
无法实现的更加丰富的任务，例如：打包优化与压缩、重新定义环境变量等等。</p>
<p>Webpack 中通过<code>plugins</code>属性来使用插件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&#x27;./app.js&#x27;</span>,</span><br><span class="line">    <span class="attr">mobile</span>: <span class="string">&#x27;./mobile.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name][chunkhash].js&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 首先需要npm install ts-loader css-loader</span></span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.ts$/</span>, <span class="attr">use</span>: <span class="string">&#x27;ts-loader&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: <span class="string">&#x27;css-loader&#x27;</span> &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 使用new操作符来创建一个插件实例</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">UglifyJsPlugin</span>(),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Webpack 的插件 plugin 本质是一个拥有<code>apply</code>属性的
JavaScript 对象，这个<code>apply</code>属性会被 Webpack
的<code>compiler</code>对象调用，而该对象可以在整个 Webpack
编译生命周期内进行访问。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LogOnBuildPlugin.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LogOnBuildPlugin</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ... ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意下面的apply原型属性和compiler对象</span></span><br><span class="line"><span class="title class_">LogOnBuildPlugin</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span> = <span class="keyword">function</span> (<span class="params">compiler</span>) &#123;</span><br><span class="line">  compiler.<span class="title function_">plugin</span>(<span class="string">&quot;run&quot;</span>, <span class="keyword">function</span> (<span class="params">compiler, callback</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;Webpack构建过程开始！&quot;</span>);</span><br><span class="line">    <span class="title function_">callback</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="webpack-模块">Webpack 模块</h2>
<p>相比 NodeJS 的模块机制，Webpack 模块所涵盖的范围显然更加丰富：</p>
<ul>
<li>ES2015 的<code>import</code>语句</li>
<li>CommonJS 的<code>require()</code>语句</li>
<li>AMD 的<code>define</code>/<code>require</code>语句</li>
<li>css/sass/less 中的<code>@import</code>语句。</li>
<li>CSS 文件中的<code>url(...)</code>或 HTML
文件中的<code>&lt;img src=...&gt;</code>所指向的图片资源链接。</li>
</ul>
<p>Webpack 通过<a target="_blank" rel="noopener" href="https://github.com/webpack/enhanced-resolve">enhanced-resolve</a>可以解析三种文件路径：</p>
<ul>
<li>绝对路径：文件在操作系统上的绝对路径。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;/home/common.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;C:\\Users\\common.js&quot;</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>相对路径：相对于当前引入操作的文件的位置。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;./source/demo.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;../demo.js&quot;</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>模块路径：在<code>resolve.modules</code>中指定的目录内搜索，默认是<code>["node_modules"]</code>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="打包策略">打包策略</h2>
<p>Webpack 构建的应用程序中，主要存在以下三种类型的代码：</p>
<ol type="1">
<li>开发人员编写的业务代码。</li>
<li>引入的第三方<code>vendor</code>库。</li>
<li>Webpack
运行时与所有模块进行交互的<code>manifest</code>（<em>[ˈmænɪfest]
n.清单</em>）。</li>
</ol>
<blockquote>
<p><code>manifest</code>是浏览器运行时，Webpack
用来连接模块所需的加载和解析逻辑（<em>无论<code>import</code>还是<code>require</code>模块语法，最后都会被
Webpack
转换为指向</em>模块标识符<em>的<code>__webpack_require__</code>方法</em>）。</p>
</blockquote>
<p>为了有效规避缓存问题，并最大化浏览器渲染性能，可以考虑将上述三种类型代码单独打包到三类文件。</p>
<p>在 Webpack 3.0 可以通过<a target="_blank" rel="noopener" href="https://doc.webpack-china.org/plugins/commons-chunk-plugin">CommonsChunkPlugin</a>插件完成这件工作。该插件可以将公共的依赖模块提取为一个新的的<code>chunk</code>文件，通过将公共模块分拆并且合成之后，便于应用进行缓存和后续使用，避免浏览器重复加载并运行同一段功能代码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">CommonsChunkPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: string, <span class="attr">names</span>: string[], <span class="comment">// 通用chunk的名称。</span></span><br><span class="line">  <span class="attr">filename</span>: string,       <span class="comment">// 公共chunk的文件名模板，可以包含与output.filename相同的占位符。</span></span><br><span class="line">  <span class="attr">chunks</span>: string[],       <span class="comment">// 通过chunk名称选择chunks的来源，其中chunk必须是公共chunk的子模块。</span></span><br><span class="line">  <span class="attr">children</span>: boolean,      <span class="comment">// 如果设置为true，所有公共chunk的子级模块会被选择。</span></span><br><span class="line">  <span class="attr">deepChildren</span>: boolean,  <span class="comment">// 如果设置为true，所有公共chunk的全部子孙模块都会被选择。</span></span><br><span class="line">  <span class="attr">async</span>: boolean|string,  <span class="comment">// 设置为true会创建一个异步的公共chunk，它会作为name的子模块以及chunks的兄弟模块，并与chunks并行被加载。</span></span><br><span class="line">  <span class="attr">minSize</span>: number,        <span class="comment">// 公共chunk创建之前，所有公共模块的最小文件尺寸。</span></span><br><span class="line">  <span class="attr">minChunks</span>: number|<span class="title class_">Infinity</span>|<span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, count</span>) -&gt; boolean,  <span class="comment">// 传入公共chunk之前，所需要包含chunks的最少数量。</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entry</span>: &#123;</span><br><span class="line">  <span class="attr">app</span>: <span class="string">&#x27;./app.js&#x27;</span>,</span><br><span class="line">  <span class="attr">vendor</span>: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;vuex&#x27;</span>, <span class="string">&#x27;vue-router&#x27;</span>, <span class="string">&#x27;element-ui&#x27;</span>, <span class="string">&#x27;axios&#x27;</span>]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">CommonsChunkPlugin</span>(&#123;</span><br><span class="line">    <span class="attr">names</span>: [<span class="string">&#x27;vendor&#x27;</span>, <span class="string">&#x27;manifest&#x27;</span>]</span><br><span class="line">  &#125;),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Webpack4
当中已经废弃了<code>CommonsChunkPlugin</code>的使用，转而采用更加简单明了的<code>optimization.splitChunks</code>和<code>optimization.runtimeChunk</code>属性完成类似工作，下面的章节马上会进行介绍。</p>
</blockquote>
<h2 id="optimization">optimization</h2>
<p>Webpack4
开始提供一个依赖于<code>mode</code>属性进行配置和优化的选项，代替过去<code>CommonsChunkPlugin</code>、<code>UglifyjsWebpackPlugin</code>等第三方插件的使用。</p>
<h3 id="minimize">minimize</h3>
<p>让 Webpack 使用<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/uglifyjs-webpack-plugin/">UglifyjsWebpackPlugin</a>进行最小化打包。Webpack
配置对象的<code>mode</code>属性为<code>production</code>时该属性默认为<code>true</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="minimizer">minimizer</h3>
<p>通过提供一个或多个不同的<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/uglifyjs-webpack-plugin/">UglifyjsWebpackPlugin</a>实例来指定一个新的压缩器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">UglifyJsPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;=</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">UglifyJsPlugin</span>(&#123;</span><br><span class="line">        <span class="comment">/* 自定义配置 */</span></span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="splitchunks">splitChunks</h3>
<p>Webpack4.0
为动态导入模块提供了一个新的通用代码文件打包策略，具体配置项可以参考本文中的<a href="#/SplitChunksPlugin">SplitChunksPlugin</a>章节。</p>
<h3 id="runtimechunk">runtimeChunk</h3>
<p>设置该属性为<code>true</code>时，可以添加额外的代码块至每个只在运行时包含的
Webpack 入口点。该属性可以通过提供一个字符串值来使用插件的预设模式：</p>
<p><code>single</code>: 建立一个所有代码块共享的运行时文件。
<code>multiple</code>: 为多个通用代码块建立多个运行时文件。</p>
<p>设置该属性为对象时，它只可能去提供<code>name</code>属性，为运行时代码块提供可替代的名称或命名工厂。</p>
<blockquote>
<p>该属性默认值为<code>false</code>，表示每个入口代码块都嵌入到运行时。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">runtimeChunk</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="function">(<span class="params">entrypoint</span>) =&gt;</span> <span class="string">`runtimechunk~<span class="subst">$&#123;entrypoint.name&#125;</span>`</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="noemitonerrors">noEmitOnErrors</h3>
<p>当编译阶段出现错误时，使用<code>optimization.noEmitOnErrors</code>跳过<code>emitting</code>阶段，从而确保不会有错误的资源被<code>emitted</code>。<code>stats</code>中的<code>emitted</code>标志对于所有资源都是<code>false</code>的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">noEmitOnErrors</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="nodeenv">nodeEnv</h3>
<p>告诉 Webpack
设置<code>process.env.NODE_ENV</code>为指定的字符串，<code>optimization.nodeEnv</code>底层使用了<code>DefinePlugin</code>插件，除非设置为<code>false</code>。如果
Webpack
对象设置了<code>mode</code>属性，那么<code>optimization.nodeEnv</code>默认为<code>mode</code>属性的值，否则将会回退为<code>"production"</code>。</p>
<ul>
<li>任意字符串：需要设置到<code>process.env.NODE ENV</code>的值。</li>
<li><code>false</code>：不设置或修改<code>process.env.NODE_ENV</code>的值。</li>
</ul>
<h2 id="splitchunksplugin">SplitChunksPlugin</h2>
<h2 id="defineplugin">DefinePlugin</h2>
<p><code>webpack.DefinePlugin</code></p>
<h2 id="moduleconcatenationplugin">ModuleConcatenationPlugin</h2>
<p>附上<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/module-concatenation-plugin/">英文原文链接</a>。</p>
<p>过去 webpack 打包的时候，每个 module
都会被包装到独立的函数闭包，这些包装函数会让 JavaScript
在浏览器中执行更缓慢。经过比较，<code>Closure Compiler</code>和<code>RollupJS</code>提升、连接全部模块作用域到一个闭包的方式，会让代码在浏览器中执行得更加迅速。因此，Webpack3
当中提供了如下 plugin 来开启类似特性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.<span class="property">optimize</span>.<span class="title class_">ModuleConcatenationPlugin</span>();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Webpack3 作用域提升的实现依赖于 ECMAScript 模块语法，因此 Webpack
会基于开发人员当前使用的模块系统回滚到过去的打包方式。</p>
</blockquote>
<h3 id="不使用-moduleconcatenationplugin-打包的文件">不使用
ModuleConcatenationPlugin 打包的文件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  bundles git:(master) ll</span><br><span class="line">总用量 8.7M</span><br><span class="line">-rw-rw-r-- 1 hank hank  24K 9月   6 11:44 0.210c1525bfe14cba4ee0.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  61K 9月   6 11:44 0.210c1525bfe14cba4ee0.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 5.9K 9月   6 11:44 1.d4b8545dc3dc93af7f6a.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  28K 9月   6 11:44 1.d4b8545dc3dc93af7f6a.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank  765 9月   6 11:44 2.57378280a5698f76c576.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 6.4K 9月   6 11:44 2.57378280a5698f76c576.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 244K 9月   6 11:44 app.13fca0a1be03d8b4a15b.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 710K 9月   6 11:44 app.13fca0a1be03d8b4a15b.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.4K 9月   6 11:44 app.24004a5d2621177eb1e6bcdabc919636.css</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.9K 9月   6 11:44 app.24004a5d2621177eb1e6bcdabc919636.css.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.6K 9月   6 11:44 manifest.c3fe0dc0d40ea3fac1a5.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  15K 9月   6 11:44 manifest.c3fe0dc0d40ea3fac1a5.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 983K 9月   6 11:44 vendor.128582091fc1c542ae63.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 6.7M 9月   6 11:44 vendor.128582091fc1c542ae63.js.map</span><br></pre></td></tr></table></figure>
<h3 id="使用-moduleconcatenationplugin-打包的文件">使用
ModuleConcatenationPlugin 打包的文件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  bundles git:(master) ✗ ll</span><br><span class="line">总用量 8.7M</span><br><span class="line">-rw-rw-r-- 1 hank hank  23K 9月   6 11:47 0.331a96e6fa24027ff29f.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  60K 9月   6 11:47 0.331a96e6fa24027ff29f.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 5.8K 9月   6 11:47 1.241c026697aa61a8ca09.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  27K 9月   6 11:47 1.241c026697aa61a8ca09.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank  714 9月   6 11:47 2.731ff84fbfc108bc253b.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 5.9K 9月   6 11:47 2.731ff84fbfc108bc253b.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.4K 9月   6 11:47 app.24004a5d2621177eb1e6bcdabc919636.css</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.9K 9月   6 11:47 app.24004a5d2621177eb1e6bcdabc919636.css.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 244K 9月   6 11:47 app.d041e73d9c21f495b099.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 709K 9月   6 11:47 app.d041e73d9c21f495b099.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 1.6K 9月   6 11:47 manifest.46788d45af925b1aa79a.js</span><br><span class="line">-rw-rw-r-- 1 hank hank  15K 9月   6 11:47 manifest.46788d45af925b1aa79a.js.map</span><br><span class="line">-rw-rw-r-- 1 hank hank 983K 9月   6 11:47 vendor.154264c34d147a00c862.js</span><br><span class="line">-rw-rw-r-- 1 hank hank 6.7M 9月   6 11:47 vendor.154264c34d147a00c862.js.map</span><br></pre></td></tr></table></figure>
<blockquote>
<p>结论：文件尺寸有一定程度上的缩小。</p>
</blockquote>
<h2 id="import-实现机制">import 实现机制</h2>
<p>Webpack 在 2.0 版本之后原生实现了<code>import</code>，而不再需要
Babel 之类加载器进行转换。</p>
<h2 id="最佳实践">最佳实践</h2>
</div><div class="article-licensing box"><div class="licensing-title"><p>Webpack 4 核心配置剖析</p><p><a href="http://www.uinio.com/Web/Webpack/">http://www.uinio.com/Web/Webpack/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hank</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2016-04-13</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2016-05-17</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/JavaScript/">JavaScript</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Web/Flux/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Flux 数据流两三事儿</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Embedded/Arduino/"><span class="level-item">玩转 Arduino Uno Mega 与 UINIO-MCU-ESP32 开源硬件</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#入口-entry"><span class="level-left"><span class="level-item">1</span><span class="level-item">入口 entry</span></span></a></li><li><a class="level is-mobile" href="#输出-output"><span class="level-left"><span class="level-item">2</span><span class="level-item">输出 output</span></span></a></li><li><a class="level is-mobile" href="#加载器-loader"><span class="level-left"><span class="level-item">3</span><span class="level-item">加载器 loader</span></span></a></li><li><a class="level is-mobile" href="#插件-plugin"><span class="level-left"><span class="level-item">4</span><span class="level-item">插件 plugin</span></span></a></li><li><a class="level is-mobile" href="#webpack-模块"><span class="level-left"><span class="level-item">5</span><span class="level-item">Webpack 模块</span></span></a></li><li><a class="level is-mobile" href="#打包策略"><span class="level-left"><span class="level-item">6</span><span class="level-item">打包策略</span></span></a></li><li><a class="level is-mobile" href="#optimization"><span class="level-left"><span class="level-item">7</span><span class="level-item">optimization</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#minimize"><span class="level-left"><span class="level-item">7.1</span><span class="level-item">minimize</span></span></a></li><li><a class="level is-mobile" href="#minimizer"><span class="level-left"><span class="level-item">7.2</span><span class="level-item">minimizer</span></span></a></li><li><a class="level is-mobile" href="#splitchunks"><span class="level-left"><span class="level-item">7.3</span><span class="level-item">splitChunks</span></span></a></li><li><a class="level is-mobile" href="#runtimechunk"><span class="level-left"><span class="level-item">7.4</span><span class="level-item">runtimeChunk</span></span></a></li><li><a class="level is-mobile" href="#noemitonerrors"><span class="level-left"><span class="level-item">7.5</span><span class="level-item">noEmitOnErrors</span></span></a></li><li><a class="level is-mobile" href="#nodeenv"><span class="level-left"><span class="level-item">7.6</span><span class="level-item">nodeEnv</span></span></a></li></ul></li><li><a class="level is-mobile" href="#splitchunksplugin"><span class="level-left"><span class="level-item">8</span><span class="level-item">SplitChunksPlugin</span></span></a></li><li><a class="level is-mobile" href="#defineplugin"><span class="level-left"><span class="level-item">9</span><span class="level-item">DefinePlugin</span></span></a></li><li><a class="level is-mobile" href="#moduleconcatenationplugin"><span class="level-left"><span class="level-item">10</span><span class="level-item">ModuleConcatenationPlugin</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#不使用-moduleconcatenationplugin-打包的文件"><span class="level-left"><span class="level-item">10.1</span><span class="level-item">不使用
ModuleConcatenationPlugin 打包的文件</span></span></a></li><li><a class="level is-mobile" href="#使用-moduleconcatenationplugin-打包的文件"><span class="level-left"><span class="level-item">10.2</span><span class="level-item">使用
ModuleConcatenationPlugin 打包的文件</span></span></a></li></ul></li><li><a class="level is-mobile" href="#import-实现机制"><span class="level-left"><span class="level-item">11</span><span class="level-item">import 实现机制</span></span></a></li><li><a class="level is-mobile" href="#最佳实践"><span class="level-left"><span class="level-item">12</span><span class="level-item">最佳实践</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C-C-%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">C/C++ 语言</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">Linux 操作系统</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Python-%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">Python 语言</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/UINIO-%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E8%B5%84%E6%96%99/"><span class="level-start"><span class="level-item">UINIO 开源项目资料</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Web-%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">Web 开发</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BA%A7%E4%B8%9A%E7%BB%8F%E6%B5%8E/"><span class="level-start"><span class="level-item">产业经济</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%96%E8%A7%82%E4%B8%8E%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">外观与结构设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/"><span class="level-start"><span class="level-item">嵌入式</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%9B%BA%E4%BB%B6/"><span class="level-start"><span class="level-item">嵌入式固件</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">开发环境配置</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"><span class="level-start"><span class="level-item">版本管理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"><span class="level-start"><span class="level-item">生活日常</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">硬件电子技术</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">算法</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%8B%B1%E8%AF%AD/"><span class="level-start"><span class="level-item">英语</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">软件工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Power-Switching/"><img src="/Electronics/Power-Switching/logo.png" alt="细说开关电源的基本原理与拓扑结构"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-03-05T16:00:00.000Z">2025-03-06</time></p><p class="title"><a href="/Electronics/Power-Switching/">细说开关电源的基本原理与拓扑结构</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Embedded/FOC/"><img src="/Embedded/FOC/logo.png" alt="剖析无刷电机的 FOC 磁场定向控制理论"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-02-19T16:00:00.000Z">2025-02-20</time></p><p class="title"><a href="/Embedded/FOC/">剖析无刷电机的 FOC 磁场定向控制理论</a></p><p class="categories"><a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Embedded/PID/"><img src="/Embedded/PID/logo.png" alt="闭环控制算法 PID 的原理剖析与实现"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-02-04T16:00:00.000Z">2025-02-05</time></p><p class="title"><a href="/Embedded/PID/">闭环控制算法 PID 的原理剖析与实现</a></p><p class="categories"><a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/Motor-PWM/"><img src="/Electronics/Motor-PWM/logo.png" alt="直流无刷电机的 PWM 驱动控制原理简述"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-11-06T16:00:00.000Z">2024-11-07</time></p><p class="title"><a href="/Electronics/Motor-PWM/">直流无刷电机的 PWM 驱动控制原理简述</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/Electronics/E-Series/"><img src="/Electronics/E-Series/logo.png" alt="美国电子工业联盟 E 系列标准参数值速查手册"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-11-05T16:00:00.000Z">2024-11-06</time></p><p class="title"><a href="/Electronics/E-Series/">美国电子工业联盟 E 系列标准参数值速查手册</a></p><p class="categories"><a href="/categories/%E7%A1%AC%E4%BB%B6%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF/">硬件电子技术</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CAD/"><span class="tag">CAD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EDA/"><span class="tag">EDA</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GCC-GDB/"><span class="tag">GCC/GDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTML/"><span class="tag">HTML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LaTeX/"><span class="tag">LaTeX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MCU/"><span class="tag">MCU</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Make/"><span class="tag">Make</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Markdown/"><span class="tag">Markdown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PCB/"><span class="tag">PCB</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python3/"><span class="tag">Python3</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Qt/"><span class="tag">Qt</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shell/"><span class="tag">Shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Solidity/"><span class="tag">Solidity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tools/"><span class="tag">Tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E6%95%B0/"><span class="tag">代数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%BF%E7%9C%9F/"><span class="tag">仿真</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%83%E5%99%A8%E4%BB%B6/"><span class="tag">元器件</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"><span class="tag">命令行</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"><span class="tag">密码学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%84%E9%A2%91/"><span class="tag">射频</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F-Linux/"><span class="tag">嵌入式 Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"><span class="tag">开发规范</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/"><span class="tag">微积分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%89%8B%E6%9C%BA/"><span class="tag">手机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6%E7%BB%93%E6%9E%84/"><span class="tag">数学结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%B0%E6%A6%82%E5%BF%B5%E8%8B%B1%E8%AF%AD/"><span class="tag">新概念英语</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"><span class="tag">服务器</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%82%E8%B0%88/"><span class="tag">杂谈</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%BD%E8%BD%A6/"><span class="tag">汽车</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E5%AD%90%E4%BB%AA%E5%99%A8/"><span class="tag">电子仪器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%9C%BA/"><span class="tag">电机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E6%BA%90/"><span class="tag">电源</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E8%B7%AF%E7%90%86%E8%AE%BA/"><span class="tag">电路理论</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"><span class="tag">网络协议</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%AD%E6%B3%95/"><span class="tag">语法</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv" style="display:inline-block;margin:auto 0.5rem;">0</span>个访客</span></p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img src="/images/ICP.png"> 蜀 ICP 备 2021027760 号</a><p class="is-size-7">Copyright © 2025 <span>UinIO 电子技术实验室</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://unpkg.com/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://unpkg.com/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://unpkg.com/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://unpkg.com/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://unpkg.com/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script src="/js/math.js"></script><script id="MathJax-script" async src="/js/es5/tex-mml-chtml.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>